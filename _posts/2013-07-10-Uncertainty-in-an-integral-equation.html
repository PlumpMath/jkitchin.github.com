---
title: Uncertainty in an integral equation
date: 2013/07/10 09:05:02
updated: 2013/07/10 09:05:02
categories: uncertainty, math
tags: 
---



<p>
In a <a href="http://jkitchin.github.io/blog/2013/01/06/Integrating-a-batch-reactor-design-equation/">previous example</a>, we solved for the time to reach a specific conversion in a batch reactor. However, it is likely there is uncertainty in the rate constant, and possibly in the initial concentration. Here we examine the effects of that uncertainty on the time to reach the desired conversion.
</p>

<p>
To do this we have to write a function that takes arguments with uncertainty, and wrap the function with the uncertainties.wrap decorator. The function must return a single float number (current limitation of the uncertainties package). Then, we simply call the function, and the uncertainties from the inputs will be automatically propagated to the outputs. Let us say there is about 10% uncertainty in the rate constant, and 1% uncertainty in the initial concentration.
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">from</span> scipy.integrate <span style="color: #8b0000;">import</span> quad
<span style="color: #8b0000;">import</span> uncertainties <span style="color: #8b0000;">as</span> u

k = u.ufloat((1.0e-3, 1.0e-4))
Ca0 = u.ufloat((1.0, 0.01))<span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">mol/L</span>

@u.wrap
<span style="color: #8b0000;">def</span> <span style="color: #8b2323;">func</span>(k, Ca0):
    <span style="color: #8b0000;">def</span> <span style="color: #8b2323;">integrand</span>(X):
        <span style="color: #8b0000;">return</span> 1./(k*Ca0)*(1./(1-X)**2)
    integral, abserr = quad(integrand, 0, 0.9)
    <span style="color: #8b0000;">return</span> integral

sol = func(k, Ca0)
<span style="color: #8b0000;">print</span> <span style="color: #228b22;">'t = {0} seconds ({1} hours)'</span>.format(sol, sol/3600)
</pre>
</div>

<pre class="example">
t = 9000.0+/-904.488801332 seconds (2.5+/-0.251246889259 hours)
</pre>

<p>
The result shows about a 10% uncertainty in the time, which is similar to the largest uncertainty in the inputs.  This information should certainly be used in making decisions about how long to actually run the reactor to be sure of reaching the goal. For example, in this case, running the reactor for 3 hours (that is roughly + 2&sigma;) would ensure at a high level of confidence (approximately 95% confidence) that you reach at least 90% conversion.  
</p>
<p>Copyright (C) 2013 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p><p><a href="/org/2013/07/10/Uncertainty-in-an-integral-equation.org">org-mode source</a><p>