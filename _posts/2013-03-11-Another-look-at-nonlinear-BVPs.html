---
title: Another look at nonlinear BVPs
date: 2013/03/11 10:44:40
updated: 2013/03/11 16:31:34
categories: BVP
tags: 
---


<p>
Adapted from <a href="http://www.mathworks.com/help/matlab/ref/bvp4c.html" >http://www.mathworks.com/help/matlab/ref/bvp4c.html</a>

</p>

<p>
Boundary value problems may have more than one solution. Let us consider the BVP:
</p>

\begin{eqnarray}
y'' + |y| &=& 0 \\
y(0) &=& 0 \\
y(4) &=& -2
\end{eqnarray}

<p>
We will see this equation has two answers, depending on your initial guess. We convert this to the following set of coupled equations:
</p>

\begin{eqnarray}
y_1' &=& y_2 \\
y_2' &=& -|y_1| \\
y_1(0)&=& 0\\
y_1(4) &=& -2
\end{eqnarray}

<p>
This BVP is nonlinear because of the absolute value. We will have to guess solutions to get started. We will guess two different solutions, both of which will be constant values.  We will use pycse.bvp to solve the equation.
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">import</span> numpy <span style="color: #8b0000;">as</span> np
<span style="color: #8b0000;">from</span> pycse <span style="color: #8b0000;">import</span> bvp
<span style="color: #8b0000;">import</span> matplotlib.pyplot <span style="color: #8b0000;">as</span> plt

<span style="color: #8b0000;">def</span> <span style="color: #8b2323;">odefun</span>(Y, x):
    y1, y2 = Y
    dy1dx = y2
    dy2dx = -np.abs(y1)
    <span style="color: #8b0000;">return</span> [dy1dx, dy2dx]

<span style="color: #8b0000;">def</span> <span style="color: #8b2323;">bcfun</span>(Ya, Yb):
    y1a, y2a = Ya
    y1b, y2b = Yb

    <span style="color: #8b0000;">return</span> [y1a, -2 - y1b]

x = np.linspace(0, 4, 100)

y1 = 1.0 * np.ones(x.shape)
y2 = 0.0 * np.ones(x.shape)

Yinit = np.vstack([y1, y2])

sol = bvp(odefun, bcfun, x, Yinit)

plt.plot(x, sol[0])

<span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">another initial guess</span>
y1 = -1.0 * np.ones(x.shape)
y2 = 0.0 * np.ones(x.shape)

Yinit = np.vstack([y1, y2])

sol = bvp(odefun, bcfun, x, Yinit)

plt.plot(x, sol[0])
plt.legend([<span style="color: #228b22;">'guess 1'</span>, <span style="color: #228b22;">'guess 2'</span>])
plt.savefig(<span style="color: #228b22;">'images/bvp-another-nonlin-1.png'</span>)
plt.show()
</pre>
</div>


<p><img src="/img/./images/bvp-another-nonlin-1.png"><p>

<p>
This example shows that a nonlinear BVP may have different solutions, and which one you get depends on the guess you make for the solution. This is analogous to solving nonlinear algebraic equations (which is what is done in solving this problem!).
</p>
<p>Copyright (C) 2013 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p><p><a href="/org/2013/03/11/Another-look-at-nonlinear-BVPs.org">org-mode source</a><p>