---
title: A nonlinear BVP
date: 2013/03/08 09:19:43
updated: 2013/03/08 09:19:43
categories: PDE
tags: 
---


<p>

Adapted from Example 8.7 in _Numerical Methods in Engineering with Python_ by Jaan Kiusalaas.
</p>

<p>
We want to solve \(y''(x) = -3 y(x) y'(x)\) with $y(0) = 0 and \(y(2) = 1\) using a finite difference method. We discretize the region and approximate the derivatives as:
</p>

<p>
\(y''(x) \approx \frac{y_{i-1} - 2 y_i + y_{i+1}}{h^2} \)
</p>

<p>
\(y'(x) \approx \frac{y_{i+1} - y_{i-1}}{2 h} \)
</p>

<p>
We define a function \(y''(x) = F(x, y, y')\). At each node in our discretized region, we will have an equation that looks like \(y''(x) - F(x, y, y') = 0\), which will be nonlinear in the unknown solution \(y\). The set of equations to solve is:
</p>

\begin{eqnarray}
y_0 - \alpha &=& 0 \\
\frac{y_{i-1} - 2 y_i + y_{i+1}}{h^2} + (3 y_i) (\frac{y_{i+1} - y_{i-1}}{2 h}) &=& 0 \\
y_L - \beta &=&0
\end{eqnarray}

<p>
Since we use a nonlinear solver, we will have to provide an initial guess to the solution. We will in this case assume a line. In other cases, a bad initial guess may lead to no solution.
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">import</span> numpy <span style="color: #8b0000;">as</span> np
<span style="color: #8b0000;">from</span> scipy.optimize <span style="color: #8b0000;">import</span> fsolve
<span style="color: #8b0000;">import</span> matplotlib.pyplot <span style="color: #8b0000;">as</span> plt

x1 = 0.0
x2 = 2.0

alpha = 0.0
beta = 1.0

N = 11
X = np.linspace(x1, x2, N)
h = (x2 - x1) / (N - 1)

<span style="color: #8b0000;">def</span> <span style="color: #8b2323;">Ypp</span>(x, y, yprime):
    <span style="color: #228b22;">'''define y'' = 3*y*y' '''</span>
    <span style="color: #8b0000;">return</span> -3.0 * y * yprime

<span style="color: #8b0000;">def</span> <span style="color: #8b2323;">residuals</span>(y):
    <span style="color: #228b22;">'''When we have the right values of y, this function will be zero.'''</span>

    res = np.zeros(y.shape)

    res[0] = y[0] - alpha
    
    <span style="color: #8b0000;">for</span> i <span style="color: #8b0000;">in</span> <span style="color: #8b0000;">range</span>(1, N - 1):
        x = X[i]
        YPP = (y[i - 1] - 2 * y[i] + y[i + 1]) / h**2
        YP = (y[i + 1] - y[i - 1]) / (2 * h)
        res[i] = YPP - Ypp(x, y[i], YP)

    res[-1] = y[-1] - beta
    <span style="color: #8b0000;">return</span> res

<span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">we need an initial guess</span>
init = alpha + (beta - alpha) / (x2 - x1) * X

Y = fsolve(residuals, init)

plt.plot(X, Y)
plt.savefig(<span style="color: #228b22;">'images/bvp-nonlinear-1.png'</span>)
</pre>
</div>

<p><img src="/img/./images/bvp-nonlinear-1.png"><p>

<p>
That code looks useful, so I put it in the pycse module in the function BVP_nl. Here is an example usage. We have to create two functions, one for the differential equation, and one for the initial guess.
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">from</span> pycse <span style="color: #8b0000;">import</span>  BVP_nl
<span style="color: #8b0000;">import</span> matplotlib.pyplot <span style="color: #8b0000;">as</span> plt

<span style="color: #8b0000;">def</span> <span style="color: #8b2323;">Ypp</span>(x, y, yprime):
    <span style="color: #228b22;">'''define y'' = 3*y*y' '''</span>
    <span style="color: #8b0000;">return</span> -3.0 * y * yprime

<span style="color: #8b0000;">def</span> <span style="color: #8b2323;">init</span>(x):
    <span style="color: #8b0000;">return</span> alpha + (beta - alpha) / (x2 - x1) * x

x1 = 0.0
x2 = 2.0

alpha = 0.0
beta = 1.0

N = 11
x, y = BVP_nl(Ypp, x1, x2, alpha, beta, init, N)

plt.plot(x, y)
plt.savefig(<span style="color: #228b22;">'images/bvp-nonlinear-2.png'</span>)
</pre>
</div>

<p><img src="/img/./images/bvp-nonlinear-2.png"><p>

<p>
The results are the same.
</p>
<p>Copyright (C) 2013 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p><p><a href="/org/2013/03/08/A-nonlinear-BVP.org">org-mode source</a><p>