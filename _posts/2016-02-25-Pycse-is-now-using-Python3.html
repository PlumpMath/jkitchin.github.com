---
title: Pycse is now using Python3
date: 2016/02/25 19:09:20
updated: 2016/02/25 19:09:20
categories: python
tags: 
---


<p>
I spent the last couple of days going through the notes for <a href="http://kitchingroup.cheme.cmu.edu/pycse">pycse</a> and updating it for Python 3! It is mostly done, and mostly was pretty easy. The Python module for pycse (<a href="http://github.com/jkitchin/pycse">http://github.com/jkitchin/pycse</a> ) should also be Python 3 compliant. Yep, on my Mac I have switched over to the Anaconda Python 3 from Continuum IO (thanks for that!).
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #0000FF;">import</span> sys
<span style="color: #0000FF;">print</span>(sys.version)
</pre>
</div>

<pre class="example">
3.5.1 |Anaconda 2.5.0 (x86_64)| (default, Dec  7 2015, 11:24:55)
[GCC 4.2.1 (Apple Inc. build 5577)]
</pre>

<p>
Now we can succinctly do matrix multiplication like this:
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #0000FF;">import</span> numpy <span style="color: #0000FF;">as</span> np
<span style="color: #BA36A5;">a</span> = np.array([1, 2, 3])
<span style="color: #BA36A5;">a</span> = np.array([1, 2, 3])
<span style="color: #0000FF;">print</span>(a @ a)  <span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">the matrix multiplication operator</span>

<span style="color: #8D8D84;"># </span><span style="color: #8D8D84; font-style: italic;">instead of</span>
<span style="color: #0000FF;">print</span>(np.dot(a, a))
</pre>
</div>

<pre class="example">
14
14
</pre>

<p>
Here is a summary of what the changes to the Python2 version of Pycse entailed.
</p>

<ol class="org-ol">
<li>Change all print statements to print functions. There were so many&#x2026;
</li>
<li>Eliminate use of tabs in some code blocks, Python3 is not flexible on that.
</li>
</ol>

<p>
I wrote this function to fix both of these for me, which worked nicely:
</p>
<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #0000FF;">defun</span> <span style="color: #006699;">fp</span> ()
  <span style="color: #036A07;">"convert print to print() allowing for line end comments. does not do multiline.</span>
<span style="color: #036A07;">and untabify"</span>
  (<span style="color: #0000FF;">interactive</span>)
  (beginning-of-line)
  (re-search-forward <span style="color: #008000;">"print "</span> (line-end-position) t)
  (delete-char -1)
  (insert <span style="color: #008000;">"("</span>)
  <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">rm spaces</span>
  (delete-forward-char
   (<span style="color: #0000FF;">save-excursion</span>
     (skip-chars-forward <span style="color: #008000;">" "</span>)))
  (<span style="color: #0000FF;">when</span>
      (re-search-forward <span style="color: #008000;">"#"</span> (line-end-position) 'move)
    (goto-char (match-beginning 0)))
  (skip-chars-backward <span style="color: #008000;">" "</span>)
  (insert <span style="color: #008000;">")"</span>)
  <span style="color: #8D8D84;">;; </span><span style="color: #8D8D84; font-style: italic;">untabify</span>
  (<span style="color: #0000FF;">let</span> ((src (org-element-context)))
    (untabify (org-element-property <span style="color: #006FE0;">:begin</span> src)
              (org-element-property <span style="color: #006FE0;">:end</span> src))))
</pre>
</div>

<ol class="org-ol">
<li>reduce no longer exists, you have to use functools.reduce. Probably will not affect me much&#x2026;
</li>
<li>Strings are sometimes bytes, and need to be encoded/decoded depending on what you are doing.
</li>
</ol>

<p>
Otherwise, most things seemed to work fine. In a few places I had articles on Windows specific code, which I couldn't test on the Mac I work on now. Only one package was apparently not ready for Python3, and that was scimath from Enthought, which had units capability. Quantities worked fine though.
</p>

<p>
For some reason I could not do interactive key-presses in matplotlib. I am not sure if that is a Python3, or my Mac setup for now.
</p>

<p>
When I first wrote the Pycse book (in org-mode naturally), I must have had a default session setup for org-mode, because there was no :session information in a few of the src-block headers. I had to add these back in a few places.
</p>

<p>
Overall the transition was pretty seamless. It looks like I will be transitioning to Python3 in teaching this fall! Big thanks to the Anaconda team for packaging Python 3.5 and making it so easy to install!
</p>
<p>Copyright (C) 2016 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p>
<p><a href="/org/2016/02/25/Pycse-is-now-using-Python3.org">org-mode source</a></p>
<p>Org-mode version = 8.2.10</p>