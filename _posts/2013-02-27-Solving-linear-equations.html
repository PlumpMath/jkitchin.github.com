---
title: Solving linear equations
date: 2013/02/27 13:13:06
updated: 2013/02/27 13:13:06
categories: Linear algebra
tags: ''
---


<p>
Given these equations, find [x1, x2, x3]
</p>
\begin{eqnarray}
x_1 - x_2 + x_3 &=& 0 \\
10 x_2 + 25 x_3 &=& 90 \\
20 x_1 + 10 x_2 &=& 80
\end{eqnarray}

<p>
reference: Kreysig, Advanced Engineering Mathematics, 9th ed. Sec. 7.3
</p>

<p>
When solving linear equations, we can represent them in matrix form. The we simply use <code>numpy.linalg.solve</code> to get the solution.
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">import</span> numpy <span style="color: #8b0000;">as</span> np
A = np.array([[1, -1, 1],
              [0, 10, 25],
              [20, 10, 0]])

b = np.array([0, 90, 80])

x = np.linalg.solve(A, b)
<span style="color: #8b0000;">print</span> x
<span style="color: #8b0000;">print</span> np.dot(A,x)

<span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">Let us confirm the solution.</span>
<span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">this shows one element is not equal because of float tolerance</span>
<span style="color: #8b0000;">print</span> np.dot(A,x) == b

<span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">here we use a tolerance comparison to show the differences is less</span>
<span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">than a defined tolerance.</span>
TOLERANCE = 1e-12
<span style="color: #8b0000;">print</span> np.abs((np.dot(A, x) - b)) &lt;= TOLERANCE
</pre>
</div>

<pre class="example">
[ 2.  4.  2.]
[  2.66453526e-15   9.00000000e+01   8.00000000e+01]
[False  True  True]
[ True  True  True]
</pre>

<p>
It can be useful to confirm there should be a solution, e.g. that the equations are all independent. The matrix rank will tell us that. Note that numpy:rank does not give you the matrix rank, but rather the number of dimensions of the array. We compute the rank by computing the number of singular values of the matrix that are greater than zero, within a prescribed tolerance. We use the <code>numpy.linalg.svd</code> function for that. In Matlab you would use the rref command to see if there are any rows that are all zero, but this command does not exist in numpy. That command does not have practical use in numerical linear algebra and has not been implemented.
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">import</span> numpy <span style="color: #8b0000;">as</span> np
A = np.array([[1, -1, 1],
              [0, 10, 25],
              [20, 10, 0]])

b = np.array([0, 90, 80])

<span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">determine number of independent rows in A we get the singular values</span>
<span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">and count the number greater than 0.</span>
TOLERANCE = 1e-12
u, s, v = np.linalg.svd(A)
<span style="color: #8b0000;">print</span> <span style="color: #228b22;">'Singular values: {0}'</span>.format(s)
<span style="color: #8b0000;">print</span> <span style="color: #228b22;">'# of independent rows: {0}'</span>.format(np.sum(np.abs(s) &gt; TOLERANCE))

<span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">to illustrate a case where there are only 2 independent rows</span>
<span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">consider this case where row3 = 2*row2.</span>
A = np.array([[1, -1, 1],
              [0, 10, 25],
              [0, 20, 50]])

u, s, v = np.linalg.svd(A)

<span style="color: #8b0000;">print</span> <span style="color: #228b22;">'Singular values: {0}'</span>.format(s)
<span style="color: #8b0000;">print</span> <span style="color: #228b22;">'# of independent rows: {0}'</span>.format(np.sum(np.abs(s) &gt; TOLERANCE))
</pre>
</div>

<pre class="example">
Singular values: [ 27.63016717  21.49453733   1.5996022 ]
# of independent rows: 3
Singular values: [ 60.21055203   1.63994657  -0.        ]
# of independent rows: 2
</pre>

<p>
<a href="http://matlab.cheme.cmu.edu/2011/08/01/solving-linear-equations/" >Matlab comparison</a>
</p>
<p>Copyright (C) 2013 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p><p><a href="/org/2013/02/27/Solving-linear-equations.org">org-mode source</a><p>