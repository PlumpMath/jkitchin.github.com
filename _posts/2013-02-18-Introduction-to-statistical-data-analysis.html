---
title: Introduction to statistical data analysis
date: 2013/02/18 09:00:00
updated: 2013/02/27 14:34:44
categories: statistics
tags: ''
---


<p>
<a href="http://matlab.cheme.cmu.edu/2011/08/27/introduction-to-statistical-data-analysis/" >Matlab post</a>
</p>

<p>
Given several measurements of a single quantity, determine the average value of the measurements, the standard deviation of the measurements and the 95% confidence interval for the average.
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">import</span> numpy <span style="color: #8b0000;">as</span> np

y = [8.1, 8.0, 8.1]

ybar = np.mean(y)
s = np.std(y, ddof=1)

<span style="color: #8b0000;">print</span> ybar, s
</pre>
</div>

<pre class="example">
&gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; 8.06666666667 0.057735026919
</pre>

<p>
Interesting, we have to specify the divisor in numpy.std by the ddof argument. The default for this in Matlab is 1, the default for this function is 0.
</p>

<p>
Here is the principle of computing a confidence interval.
</p>

<ol>
<li>compute the average
</li>
<li>Compute the standard deviation of your data
</li>
<li>Define the confidence interval, e.g. 95% = 0.95
</li>
<li>compute the student-t multiplier. This is a function of the
confidence interval you specify, and the number of data points
you have minus 1. You subtract 1 because one degree of freedom
is lost from calculating the average.
</li>
</ol>

<p>
The confidence interval is defined as ybar +- T_multiplier*std/sqrt(n).
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">from</span> scipy.stats.distributions <span style="color: #8b0000;">import</span>  t
ci = 0.95
alpha = 1.0 - ci

n = <span style="color: #8b0000;">len</span>(y)
T_multiplier = t.ppf(1.0 - alpha / 2.0, n - 1)

ci95 = T_multiplier * s / np.sqrt(n)

<span style="color: #8b0000;">print</span> <span style="color: #228b22;">'T_multiplier = {0}'</span>.format(T_multiplier)
<span style="color: #8b0000;">print</span> <span style="color: #228b22;">'ci95 = {0}'</span>.format(ci95)
<span style="color: #8b0000;">print</span> <span style="color: #228b22;">'The true average is between {0} and {1} at a 95% confidence level'</span>.format(ybar - ci95, ybar + ci95)
</pre>
</div>

<pre class="example">
&gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; T_multiplier = 4.30265272991
ci95 = 0.143421757664
The true average is between 7.923244909 and 8.21008842433 at a 95% confidence level
</pre>
<p>Copyright (C) 2013 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p><p><a href="/org/2013/02/18/Introduction-to-statistical-data-analysis.org">org-mode source</a><p>