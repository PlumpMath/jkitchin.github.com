---
title: Transient heat conduction - partial differential equations
date: 2013/03/07 15:54:08
updated: 2013/03/07 16:25:52
categories: PDE
tags: heat transfer
---


<p>
<a href="http://matlab.cheme.cmu.edu/2011/08/21/transient-heat-conduction-partial-differential-equations/" >Matlab post</a>
adapated from <a href="http://msemac.redwoods.edu/~darnold/math55/DEproj/sp02/AbeRichards/slideshowdefinal.pdf" >http://msemac.redwoods.edu/~darnold/math55/DEproj/sp02/AbeRichards/slideshowdefinal.pdf</a>

</p>

<p>
We solved a steady state BVP modeling heat conduction. Today we examine the transient behavior of a rod at constant T put between two heat reservoirs at different temperatures, again T1 = 100, and T2 = 200. The rod will start at 150. Over time, we should expect a solution that approaches the steady state solution: a linear temperature profile from one side of the rod to the other.
</p>

<p>
\(\frac{\partial u}{\partial t} = k \frac{\partial^2 u}{\partial x^2}\)
</p>

<p>
at \(t=0\), in this example we have \(u_0(x) = 150\) as an initial condition. with boundary conditions \(u(0,t)=100\) and \(u(L,t)=200\).
</p>

<p>
In Matlab there is the pdepe command. There is not yet a PDE solver in scipy. Instead, we will utilze the method of lines to solve this problem. We discretize the rod into segments, and approximate the second derivative in the spatial dimension as \(\frac{\partial^2 u}{\partial x^2} = (u(x + h) - 2 u(x) + u(x-h))/ h^2\) at each node. This leads to a set of coupled ordinary differential equations that is easy to solve.
</p>

<p>
Let us say the rod has a length of 1, \(k=0.02\), and solve for the time-dependent temperature profiles.
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">import</span> numpy <span style="color: #8b0000;">as</span> np
<span style="color: #8b0000;">from</span> scipy.integrate <span style="color: #8b0000;">import</span> odeint
<span style="color: #8b0000;">import</span> matplotlib.pyplot <span style="color: #8b0000;">as</span> plt

N = 100  <span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">number of points to discretize</span>
L = 1.0
X = np.linspace(0, L, N) <span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">position along the rod</span>
h = L / (N - 1)

k = 0.02

<span style="color: #8b0000;">def</span> <span style="color: #8b2323;">odefunc</span>(u, t):
    dudt = np.zeros(X.shape)

    dudt[0] = 0 <span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">constant at boundary condition</span>
    dudt[-1] = 0

    <span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">now for the internal nodes</span>
    <span style="color: #8b0000;">for</span> i <span style="color: #8b0000;">in</span> <span style="color: #8b0000;">range</span>(1, N-1):
        dudt[i] = k * (u[i + 1] - 2*u[i] + u[i - 1]) / h**2

    <span style="color: #8b0000;">return</span> dudt

init = 150.0 * np.ones(X.shape) <span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">initial temperature</span>
init[0] = 100.0  <span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">one boundary condition</span>
init[-1] = 200.0 <span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">the other boundary condition</span>

tspan = np.linspace(0.0, 5.0, 100)
sol = odeint(odefunc, init, tspan)


<span style="color: #8b0000;">for</span> i <span style="color: #8b0000;">in</span> <span style="color: #8b0000;">range</span>(0, <span style="color: #8b0000;">len</span>(tspan), 5):
    plt.plot(X, sol[i], label=<span style="color: #228b22;">'t={0:1.2f}'</span>.format(tspan[i]))

<span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">put legend outside the figure</span>
plt.legend(loc=<span style="color: #228b22;">'center left'</span>, bbox_to_anchor=(1, 0.5))
plt.xlabel(<span style="color: #228b22;">'X position'</span>)
plt.ylabel(<span style="color: #228b22;">'Temperature'</span>)

<span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">adjust figure edges so the legend is in the figure</span>
plt.subplots_adjust(top=0.89, right=0.77)
plt.savefig(<span style="color: #228b22;">'images/pde-transient-heat-1.png'</span>)


<span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">Make a 3d figure</span>
<span style="color: #8b0000;">from</span> mpl_toolkits.mplot3d <span style="color: #8b0000;">import</span> Axes3D
fig = plt.figure()
ax = fig.add_subplot(111, projection=<span style="color: #228b22;">'3d'</span>)

SX, ST = np.meshgrid(X, tspan)
ax.plot_surface(SX, ST, sol, cmap=<span style="color: #228b22;">'jet'</span>)
ax.set_xlabel(<span style="color: #228b22;">'X'</span>)
ax.set_ylabel(<span style="color: #228b22;">'time'</span>)
ax.set_zlabel(<span style="color: #228b22;">'T'</span>)
ax.view_init(elev=15, azim=-124) <span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">adjust view so it is easy to see</span>
plt.savefig(<span style="color: #228b22;">'images/pde-transient-heat-3d.png'</span>)

<span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">animated solution. We will use imagemagick for this</span>

<span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">we save each frame as an image, and use the imagemagick convert command to </span>
<span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">make an animated gif</span>
<span style="color: #8b0000;">for</span> i <span style="color: #8b0000;">in</span> <span style="color: #8b0000;">range</span>(len(tspan)):
    plt.clf()
    plt.plot(X, sol[i])
    plt.xlabel(<span style="color: #228b22;">'X'</span>)
    plt.ylabel(<span style="color: #228b22;">'T(X)'</span>)
    plt.title(<span style="color: #228b22;">'t = {0}'</span>.format(tspan[i]))
    plt.savefig(<span style="color: #228b22;">'___t{0:03d}.png'</span>.format(i))

<span style="color: #8b0000;">import</span> commands
<span style="color: #8b0000;">print</span> commands.getoutput(<span style="color: #228b22;">'convert -quality 100 ___t*.png images/transient_heat.gif'</span>)
<span style="color: #8b0000;">print</span> commands.getoutput(<span style="color: #228b22;">'rm ___t*.png'</span>) <span style="color: #ff0000; font-weight: bold;">#</span><span style="color: #ff0000; font-weight: bold;">remove temp files</span>
</pre>
</div>

<pre class="example">
</pre>

<p>
This version of the graphical solution is not that easy to read, although with some study you can see the solution evolves from the initial condition which is flat, to the steady state solution which is a linear temperature ramp.
<p><img src="/img/./images/pde-transient-heat-1.png"><p>
</p>

<p>
The 3d version may be easier to interpret. The temperature profile starts out flat, and gradually changes to the linear ramp.
<p><img src="/img/./images/pde-transient-heat-3d.png"><p>
</p>

<p>
Finally, the animated solution.
</p>

<p><img src="/img/./images/transient_heat.gif"><p>
<p>Copyright (C) 2013 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p><p><a href="/org/2013/03/07/Transient-heat-conduction---partial-differential-equations.org">org-mode source</a><p>