---
title: OMG A Lisp that runs python
date: 2016/03/30 17:10:17
updated: 2016/03/31 13:54:47
categories: python,lisp
tags: 
---



<p>
For a year now I have struggled with abandoning Python for Lisp. It's complicated, I have used Python for 15 years now, and have a lot of skill and knowledge in it. I have used emacs-lisp for about 5 years now, and have a far bit of skill with it too. They solve really different problems. Between the two, I find I <i>like</i> writing and editing elisp <b>lots</b> better than writing Python, except it lacks the scipy+numpy+matplotlib stack. I looked into Racket and Common Lisp, but they also don't really have that as nicely as Python does at the moment. It hit me earlier today that a Lisp that compiled to Python might be the right middle ground. I had seen this project Hy (<a href="http://docs.hylang.org/en/latest/quickstart.html">http://docs.hylang.org/en/latest/quickstart.html</a> ) earlier, but didn't connect the dots to this.
</p>

<p>
Let me do that here. First, an obligatory execute function to run org-mode code blocks.
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #0000FF;">defun</span> <span style="color: #006699;">org-babel-execute:hy</span> (body params)
  (<span style="color: #0000FF;">let*</span> ((temporary-file-directory <span style="color: #008000;">"."</span>)
         (tempfile (make-temp-file <span style="color: #008000;">"hy-"</span>)))
    (<span style="color: #0000FF;">with-temp-file</span> tempfile
      (insert body))
    (<span style="color: #0000FF;">unwind-protect</span>
        (shell-command-to-string
         (format <span style="color: #008000;">"hy %s"</span> tempfile))
      (delete-file tempfile))))
</pre>
</div>

<pre class="example">
org-babel-execute:hy
</pre>

<p>
Now the basic Hello world example. It looks like lisp.
</p>
<div class="org-src-container">

<pre class="src src-hy">(<span style="color: #006FE0;">print</span> <span style="color: #008000;">"Hy world"</span>)
</pre>
</div>

<pre class="example">
Hy world
</pre>

<p>
Now for a use that looks like Python:
</p>

<div class="org-src-container">

<pre class="src src-hy">(<span style="color: #0000FF;">import</span> <span style="color: #006699;">numpy</span>)
(<span style="color: #006FE0;">setv</span> a (numpy.array [1 2 3]))
(<span style="color: #006FE0;">setv</span> b (numpy.array [1 2 3]))
(<span style="color: #006FE0;">print</span> (numpy.dot a b))
</pre>
</div>

<pre class="example">
14
</pre>

<p>
WHAT!!!!
</p>

<p>
A simple plot? Surely it can't be so easy&#x2026;
</p>
<div class="org-src-container">

<pre class="src src-hy">(import [matplotlib.pyplot <span style="color: #D0372D;">:as</span> plt])
(plt.plot [1 2 4 8])
(plt.xlabel <span style="color: #008000;">"x"</span>)
(plt.ylabel <span style="color: #008000;">"y"</span>)
(plt.savefig <span style="color: #008000;">"hy-test.png"</span>)
</pre>
</div>

<pre class="example">
2016-03-30 17:09:40.826 Python[94292:d13] CoreText performance note: Client called CTFontCreateWithName() using name "Lucida Grande" and got font with PostScript name "LucidaGrande". For best performance, only use PostScript names when calling this API.
2016-03-30 17:09:40.826 Python[94292:d13] CoreText performance note: Set a breakpoint on CTFontLogSuboptimalRequest to debug.
</pre>


<div class="figure">
<p><img src="/media/2016-03-30-OMG-A-Lisp-that-runs-python/hy-test.png"> 
</p>
</div>

<p>
Wow. I am not sure what the warnings are, I seem to get them on my Mac for some reason. How about solving an equation?
</p>

<div class="org-src-container">

<pre class="src src-hy">(import [scipy.optimize [fsolve]])
(<span style="color: #0000FF;">defn</span> <span style="color: #006699;">objective</span> [x] (<span style="color: #006FE0;">-</span> 2 x))
(<span style="color: #006FE0;">print</span> (fsolve objective -1))
</pre>
</div>

<pre class="example">
[ 2.]
</pre>


<pre class="example">
     _.-^^---....,,--
 _--                  --_
&lt;                        &gt;)
|                         |
 \._                   _./
    ```--. . , ; .--'''
          | |   |
       .-=||  | |=-.
       `-=#$%&amp;%$#=-'
          | ;  :|
 _____.,-#%&amp;$@%#&amp;#~,._____
       _---~~(~~-_.
     _{        )   )
   ,   ) -~~- ( ,-' )_
  (  `-,_..`., )-- '_,)
 ( ` _)  (  -~( -_ `,  }
 (_-  _  ~_-~~~~`,  ,' )  &lt;---- My brain right now...
   `~ -^(    __;-,((()))
         ~~~~ {_ -_(())
                `\  }
                  { }
</pre>

<p>
I may not be able to sleep tonight&#x2026;
</p>

<p>
Ascii art courtesy of <a href="http://chris.com/ascii/index.php?art=people/body%20parts/brains">http://chris.com/ascii/index.php?art=people/body%20parts/brains</a> and <a href="http://www.ascii-code.com/ascii-art/weapons/explosives.php">http://www.ascii-code.com/ascii-art/weapons/explosives.php</a> .</p>
<p>Copyright (C) 2016 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p>
<p><a href="/org/2016/03/30/OMG-A-Lisp-that-runs-python.org">org-mode source</a></p>
<p>Org-mode version = 8.2.10</p>