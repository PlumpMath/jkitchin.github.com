---
title: Time dependent concentration in a first order reversible reaction in a batch reactor.
date: 2013/02/05 09:00:00
updated: 2013/03/03 10:59:55
categories: ODE
permalink: http://jkitchin.github.com/blog/2013/02/05/Time-dependent-concentration-in-a-first-order-reversible-reaction-in-a-batch-reactor./index.html
tags: Reaction engineering
---



<p>
<a href="http://matlab.cheme.cmu.edu/2011/08/07/first-order-reversible-reaction-in-batch-reactor/" >Matlab post</a>
</p>

<p>
Given this reaction \(A \rightleftharpoons B\), with these rate laws:
</p>

<p>
forward rate law: \(-r_a = k_1 C_A\)
</p>

<p>
backward rate law: \(-r_b = k_{-1} C_B\)
</p>

<p>
plot the concentration of A vs. time. This example illustrates a set of coupled first order ODES.
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">from</span> scipy.integrate <span style="color: #8b0000;">import</span> odeint
<span style="color: #8b0000;">import</span> numpy <span style="color: #8b0000;">as</span> np

<span style="color: #8b0000;">def</span> <span style="color: #8b2323;">myode</span>(C, t):
    <span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">ra = -k1*Ca</span>
    <span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">rb = -k_1*Cb</span>
    <span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">net rate for production of A:  ra - rb</span>
    <span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">net rate for production of B: -ra + rb</span>

    k1 = 1   <span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">1/min;</span>
    k_1 = 0.5   <span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">1/min;</span>

    Ca = C[0]
    Cb = C[1]

    ra = -k1 * Ca
    rb = -k_1 * Cb

    dCadt =  ra - rb
    dCbdt = -ra + rb

    dCdt = [dCadt, dCbdt]
    <span style="color: #8b0000;">return</span> dCdt

tspan = np.linspace(0, 5)

init = [1, 0]  <span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">mol/L</span>
C = odeint(myode, init, tspan)

Ca = C[:,0]
Cb = C[:,1]

<span style="color: #8b0000;">import</span> matplotlib.pyplot <span style="color: #8b0000;">as</span> plt
plt.plot(tspan, Ca, tspan, Cb)
plt.xlabel(<span style="color: #228b22;">'Time (min)'</span>)
plt.ylabel(<span style="color: #228b22;">'C (mol/L)'</span>)
plt.legend([<span style="color: #228b22;">'$C_A$'</span>, <span style="color: #228b22;">'$C_B$'</span>])
plt.savefig(<span style="color: #228b22;">'images/reversible-batch.png'</span>)
</pre>
</div>

<p><img src="/img/./images/reversible-batch.png"><p>

<p>
That is it. The main difference between this and Matlab is the order of arguments in odeint is different, and the ode function has differently ordered arguments. 
</p>
<p>Copyright (C) 2013 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p><p><a href="/org/2013/02/05/Time-dependent-concentration-in-a-first-order-reversible-reaction-in-a-batch-reactor..org">org-mode source</a><p>