---
title: Pandoc does org-mode now
date: 2014/07/17 10:04:41
updated: 2014/07/17 10:04:41
categories: 
tags: 
---


<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#sec-1">1. A subsection with some equations</a></li>
<li><a href="#sec-2">2. A section with a figure</a></li>
<li><a href="#sec-3">3. A section with a table</a></li>
<li><a href="#sec-4">4. Some citations</a></li>
<li><a href="#sec-5">5. some source code</a></li>
</ul>
</div>
</div>

<p>
Pandoc (<a href="http://johnmacfarlane.net/pandoc/">http://johnmacfarlane.net/pandoc/</a> ) is a document converter. It does a pretty good job of converting a document in one format to another. Pandoc also knows about org-mode now, and can convert an org-file to a Word document! We are going to test it out in this post to see what it does well with.
</p>

<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1"><span class="section-number-2">1</span> A subsection with some equations</h2>
<div class="outline-text-2" id="text-1">
<p>
Einstein showed us that \(E = mc^2\). 
</p>

<p>
A matrix looks like this:
</p>

\begin{equation}
\begin{matrix}
  a & b & c \\
  d & e & f \\
  g & h & i
 \end{matrix}
\end{equation}
</div>
</div>

<div id="outline-container-sec-2" class="outline-2">
<h2 id="sec-2"><span class="section-number-2">2</span> A section with a figure</h2>
<div class="outline-text-2" id="text-2">
<p>
Here is a figure in the document.
</p>


<div class="figure">
<p><img src="/media/2014-07-17-Pandoc-does-org-mode-now/cos-plot.png"> 
</p>
<p><span class="figure-number">Figure 1:</span> A cosine function.</p>
</div>
</div>
</div>

<div id="outline-container-sec-3" class="outline-2">
<h2 id="sec-3"><span class="section-number-2">3</span> A section with a table</h2>
<div class="outline-text-2" id="text-3">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<caption class="t-above"><span class="table-number">Table 1:</span> A simple table.</caption>

<colgroup>
<col  class="right" />

<col  class="right" />
</colgroup>
<thead>
<tr>
<th scope="col" class="right">x</th>
<th scope="col" class="right">y</th>
</tr>
</thead>
<tbody>
<tr>
<td class="right">1</td>
<td class="right">1</td>
</tr>

<tr>
<td class="right">2</td>
<td class="right">4</td>
</tr>

<tr>
<td class="right">3</td>
<td class="right">9</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-sec-4" class="outline-2">
<h2 id="sec-4"><span class="section-number-2">4</span> Some citations</h2>
<div class="outline-text-2" id="text-4">
<p>
For fun, a reference to the org-mode book <a href="#dominik-2010-org-mode">dominik-2010-org-mode</a>.
</p>
</div>
</div>

<div id="outline-container-sec-5" class="outline-2">
<h2 id="sec-5"><span class="section-number-2">5</span> some source code</h2>
<div class="outline-text-2" id="text-5">
<p>
here is a python block.
</p>

<div class="org-src-container">

<pre class="src src-python">print 'hello pandoc'
</pre>
</div>

<pre class="example">
hello pandoc
</pre>

<p>
and finally, we write a block that will convert this file to a word document.
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(save-buffer)
(shell-command "pandoc -s -s org-to-word.org -o org-to-word.docx")
</pre>
</div>

<pre class="example">
0
</pre>

<p>
Now, here is that <a href="/media/2014-07-17-Pandoc-does-org-mode-now/org-to-word.docx">org-to-word.docx</a> 
</p>

<p>
it is pretty good, and blazing fast. The output is not quite as good as the native org to pdf (<a href="/media/2014-07-17-Pandoc-does-org-mode-now/org-to-word.pdf">org-to-word.pdf</a> ), but since the translation is happening outside of Emacs the results are still pretty impressive, and if you need a Word document there is no substitute <sup><a id="fnr.1" name="fnr.1" class="footref" href="#fn.1">1</a></sup>. The simple equation was translated to a Word equation format (cool!) but the matrix did not show up in the word document, nor did the figure caption. The code does show up, but the lines are not numbered as they are in the pdf. The citation did not work out of the box. The User guide suggests it might be possible to get this to work with a citations extension though.
</p>

<p>
I am impressed that the Word document has proper section headings. Overall, my impression is that this is a very good way to get 90+% of the way to a finished word document with an org-source file!
</p>
</div>
</div>
<div id="footnotes">
<h2 class="footnotes">Footnotes: </h2>
<div id="text-footnotes">

<div class="footdef"><sup><a id="fn.1" name="fn.1" class="footnum" href="#fnr.1">1</a></sup> <p class="footpara">
Ok, there is the ODT export engine. So far I have not been able to make that export documents that Word can open though, and it takes more configuration than just installing Pandoc.
</p></div>


</div>
</div><p>Copyright (C) 2014 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p><p><a href="/org/2014/07/17/Pandoc-does-org-mode-now.org">org-mode source</a><p><p>Org-mode version = 8.2.6</p>