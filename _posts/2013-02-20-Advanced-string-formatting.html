---
title: Advanced string formatting
date: 2013/02/20 09:00:00
updated: 2013/02/27 14:50:32
categories: python
---


<p>
There are several more advanced ways to include formatted values in a string. In the previous case we examined replacing format specifiers by <i>positional</i> arguments in the format command. We can instead use <i>keyword</i> arguments. 
</p>

<div class="org-src-container">

<pre class="src src-python">s = <span style="color: #228b22;">'The {speed} {color} fox'</span>.format(color=<span style="color: #228b22;">'brown'</span>, speed=<span style="color: #228b22;">'quick'</span>)
<span style="color: #8b0000;">print</span> s
</pre>
</div>

<pre class="example">
The quick brown fox
</pre>

<p>
If you have a lot of variables already defined in a script, it is convenient to use them in string formatting with the locals command:
</p>

<div class="org-src-container">

<pre class="src src-python">speed = <span style="color: #228b22;">'slow'</span>
color= <span style="color: #228b22;">'blue'</span>

<span style="color: #8b0000;">print</span> <span style="color: #228b22;">'The {speed} {color} fox'</span>.format(**<span style="color: #8b0000;">locals</span>())
</pre>
</div>

<pre class="example">
The slow blue fox
</pre>

<p>
If you want to access attributes on an object, you can specify them directly in the format identifier.
</p>
<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">class</span> <span style="color: #4682b4;">A</span>:
    <span style="color: #8b0000;">def</span> <span style="color: #8b2323;">__init__</span>(<span style="color: #8b0000;">self</span>, a, b, c):
        <span style="color: #8b0000;">self</span>.a = a
        <span style="color: #8b0000;">self</span>.b = b
        <span style="color: #8b0000;">self</span>.c = c

mya = A(3,4,5)

<span style="color: #8b0000;">print</span> <span style="color: #228b22;">'a = {obj.a}, b = {obj.b}, c = {obj.c:1.2f}'</span>.format(obj=mya)
</pre>
</div>

<pre class="example">
a = 3, b = 4, c = 5.00
</pre>

<p>
You can access values of a dictionary:
</p>
<div class="org-src-container">

<pre class="src src-python">d = {<span style="color: #228b22;">'a'</span>: 56, <span style="color: #228b22;">"test"</span>:<span style="color: #228b22;">'woohoo!'</span>}

<span style="color: #8b0000;">print</span> <span style="color: #228b22;">"the value of a in the dictionary is {obj[a]}. It works {obj[test]}"</span>.format(obj=d)
</pre>
</div>

<pre class="example">
the value of a in the dictionary is 56. It works woohoo!.
</pre>

<p>
And, you can access elements of a list. Note, however you cannot use -1 as an index in this case.
</p>

<div class="org-src-container">

<pre class="src src-python">L = [4, 5, <span style="color: #228b22;">'cat'</span>]

<span style="color: #8b0000;">print</span> <span style="color: #228b22;">'element 0 = {obj[0]}, and the last element is {obj[2]}'</span>.format(obj=L)
</pre>
</div>

<pre class="example">
element 0 = 4, and the last element is cat
</pre>

<p>
There are three different ways to &ldquo;print&rdquo; an object. If an object has a <span style="text-decoration:underline;"><span style="text-decoration:underline;">format</span></span> function, that is the default used in the format command. It may be helpful to use the <code>str</code> or <code>repr</code> of an object instead. We get this with !s for <code>str</code> and !r for <code>repr</code>.
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">class</span> <span style="color: #4682b4;">A</span>:
    <span style="color: #8b0000;">def</span> <span style="color: #8b2323;">__init__</span>(<span style="color: #8b0000;">self</span>, a, b):
        <span style="color: #8b0000;">self</span>.a = a; <span style="color: #8b0000;">self</span>.b = b

    <span style="color: #8b0000;">def</span> <span style="color: #8b2323;">__format__</span>(<span style="color: #8b0000;">self</span>, format):
        s = <span style="color: #228b22;">'a={{0:{0}}} b={{1:{0}}}'</span>.format(format)
        <span style="color: #8b0000;">return</span> s.format(<span style="color: #8b0000;">self</span>.a, <span style="color: #8b0000;">self</span>.b)

    <span style="color: #8b0000;">def</span> <span style="color: #8b2323;">__str__</span>(<span style="color: #8b0000;">self</span>):
        <span style="color: #8b0000;">return</span> <span style="color: #228b22;">'str: class A, a={0} b={1}'</span>.format(<span style="color: #8b0000;">self</span>.a, <span style="color: #8b0000;">self</span>.b)

    <span style="color: #8b0000;">def</span> <span style="color: #8b2323;">__repr__</span>(<span style="color: #8b0000;">self</span>):
        <span style="color: #8b0000;">return</span> <span style="color: #228b22;">'representing: class A, a={0}, b={1}'</span>.format(<span style="color: #8b0000;">self</span>.a, <span style="color: #8b0000;">self</span>.b)

mya = A(3, 4)

<span style="color: #8b0000;">print</span> <span style="color: #228b22;">'{0}'</span>.format(mya)   <span style="color: #ff0000; font-weight: bold;"># uses __format__</span>
<span style="color: #8b0000;">print</span> <span style="color: #228b22;">'{0!s}'</span>.format(mya) <span style="color: #ff0000; font-weight: bold;"># uses __str__</span>
<span style="color: #8b0000;">print</span> <span style="color: #228b22;">'{0!r}'</span>.format(mya) <span style="color: #ff0000; font-weight: bold;"># uses __repr__</span>
</pre>
</div>

<pre class="example">
a=3 b=4
str: class A, a=3 b=4
representing: class A, a=3, b=4
</pre>

<p>
This covers the majority of string formatting requirements I have come across. If there are more sophisticated needs, they can be met with various string templating python modules. the one I have used most is <a href="http://www.cheetahtemplate.org/" >Cheetah</a>.</p>
<p>Copyright (C) 2013 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p><p><a href="/org/2013/02/20/Advanced-string-formatting.org">org-mode source</a><p>