---
title: Defining functions in python
date: 2013/02/27 14:49:41
updated: 2013/03/06 18:28:55
categories: python
tags: 
---



<p>
Compare what's here to the <a href="http://matlab.cheme.cmu.edu/2011/08/09/where-its-i-got-two-turntables-and-a-microphone/" >Matlab implementation. </a>
</p>

<p>
We often need to make functions in our codes to do things. 
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">def</span> <span style="color: #8b2323;">f</span>(x):
    <span style="color: #228b22;">"return the inverse square of x"</span>
    <span style="color: #8b0000;">return</span> 1.0 / x**2

<span style="color: #8b0000;">print</span> f(3)
<span style="color: #8b0000;">print</span> f([4,5])
</pre>
</div>

<pre class="example">
... ... &gt;&gt;&gt; 0.111111111111
Traceback (most recent call last):
  File "&lt;stdin&gt;", line 1, in &lt;module&gt;
  File "&lt;stdin&gt;", line 3, in f
TypeError: unsupported operand type(s) for ** or pow(): 'list' and 'int'
</pre>

<p>
Note that functions are not automatically vectorized. That is why we see the error above. There are a few ways to achieve that. One is to &ldquo;cast&rdquo; the input variables to objects that support vectorized operations, such as numpy.array objects.
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">import</span> numpy <span style="color: #8b0000;">as</span> np

<span style="color: #8b0000;">def</span> <span style="color: #8b2323;">f</span>(x):
    <span style="color: #228b22;">"return the inverse square of x"</span>
    x = np.array(x)
    <span style="color: #8b0000;">return</span> 1.0 / x**2

<span style="color: #8b0000;">print</span> f(3)
<span style="color: #8b0000;">print</span> f([4,5])
</pre>
</div>

<pre class="example">
&gt;&gt;&gt; ... ... ... ... &gt;&gt;&gt; 0.111111111111
[ 0.0625  0.04  ]
</pre>

<p>
It is possible to have more than one variable.
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">import</span> numpy <span style="color: #8b0000;">as</span> np

<span style="color: #8b0000;">def</span> <span style="color: #8b2323;">func</span>(x, y):
    <span style="color: #228b22;">"return product of x and y"</span>
    <span style="color: #8b0000;">return</span> x * y

<span style="color: #8b0000;">print</span> func(2, 3)
<span style="color: #8b0000;">print</span> func(np.array([2, 3]), np.array([3, 4]))
</pre>
</div>

<pre class="example">
6
[ 6 12]
</pre>

<p>
You can define &ldquo;lambda&rdquo; functions, which are also known as inline or anonymous functions. The syntax is <code>lambda var:f(var)</code>. I think these are hard to read and discourage their use. Here is a typical usage where you have to define a simple function that is passed to another function, e.g. scipy.integrate.quad to perform an integral.
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">from</span> scipy.integrate <span style="color: #8b0000;">import</span> quad
<span style="color: #8b0000;">print</span> quad(<span style="color: #8b0000;">lambda</span> x:x**3, 0 ,2)
</pre>
</div>

<pre class="example">
(4.0, 4.440892098500626e-14)
</pre>

<p>
It is possible to nest functions inside of functions like this.
</p>
<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">def</span> <span style="color: #8b2323;">wrapper</span>(x):
    a = 4
    <span style="color: #8b0000;">def</span> <span style="color: #8b2323;">func</span>(x, a):
        <span style="color: #8b0000;">return</span> a * x

    <span style="color: #8b0000;">return</span> func(x, a)

<span style="color: #8b0000;">print</span> wrapper(4)
</pre>
</div>

<pre class="example">
16
</pre>

<p>
An alternative approach is to &ldquo;wrap&rdquo; a function, say to fix a parameter. You might do this so you can integrate the wrapped function, which depends on only a single variable, whereas the original function depends on two variables.
</p>
<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">def</span> <span style="color: #8b2323;">func</span>(x, a):
        <span style="color: #8b0000;">return</span> a * x
 
<span style="color: #8b0000;">def</span> <span style="color: #8b2323;">wrapper</span>(x):
    a = 4
    <span style="color: #8b0000;">return</span> func(x, a)

<span style="color: #8b0000;">print</span> wrapper(4)
</pre>
</div>

<pre class="example">
16
</pre>

<p>
Last example, defining a function for an ode
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">from</span> scipy.integrate <span style="color: #8b0000;">import</span> odeint
<span style="color: #8b0000;">import</span> numpy <span style="color: #8b0000;">as</span> np
<span style="color: #8b0000;">import</span> matplotlib.pyplot <span style="color: #8b0000;">as</span> plt

k = 2.2
<span style="color: #8b0000;">def</span> <span style="color: #8b2323;">myode</span>(t,y):
    <span style="color: #228b22;">"ode defining exponential growth"</span>
    <span style="color: #8b0000;">return</span> k * t

y0 = 3
tspan = np.linspace(0,1)
y =  odeint(myode, y0, tspan)

plt.plot(tspan, y)
plt.xlabel(<span style="color: #228b22;">'Time'</span>)
plt.ylabel(<span style="color: #228b22;">'y'</span>)
plt.savefig(<span style="color: #228b22;">'images/funcs-ode.png'</span>)
</pre>
</div>

<p><img src="/img/./images/funcs-ode.png"><p>
<p>Copyright (C) 2013 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p><p><a href="/org/2013/02/27/Defining-functions-in-python.org">org-mode source</a><p>