---
title: Fit a line to numerical data
date: 2013/02/18 09:00:00
updated: 2013/02/27 14:38:23
categories: data analysis
tags: ''
---


<p>
<a href="http://matlab.cheme.cmu.edu/2011/08/04/fit-a-line-to-numerical-data/" >Matlab post</a>
</p>

<p>
We want to fit a line to this data:
</p>

<div class="org-src-container">

<pre class="src src-python">x = [0, 0.5, 1, 1.5, 2.0, 3.0, 4.0, 6.0, 10]
y = [0, -0.157, -0.315, -0.472, -0.629, -0.942, -1.255, -1.884, -3.147]
</pre>
</div>

<p>
We use the polyfit(x, y, n) command where n is the polynomial order, n=1 for a line.
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">import</span> numpy <span style="color: #8b0000;">as</span> np

p = np.polyfit(x, y, 1)
<span style="color: #8b0000;">print</span> p
slope, intercept = p
<span style="color: #8b0000;">print</span> slope, intercept
</pre>
</div>

<pre class="example">
&gt;&gt;&gt; &gt;&gt;&gt; [-0.31452218  0.00062457]
&gt;&gt;&gt; -0.3145221843 0.00062457337884
</pre>

<p>
To show the fit, we can use numpy.polyval to evaluate the fit at many points.
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">import</span> matplotlib.pyplot <span style="color: #8b0000;">as</span> plt

xfit = np.linspace(0, 10)
yfit = np.polyval(p, xfit)

plt.plot(x, y, <span style="color: #228b22;">'bo'</span>, label=<span style="color: #228b22;">'raw data'</span>)
plt.plot(xfit, yfit, <span style="color: #228b22;">'r-'</span>, label=<span style="color: #228b22;">'fit'</span>)
plt.xlabel(<span style="color: #228b22;">'x'</span>)
plt.ylabel(<span style="color: #228b22;">'y'</span>)
plt.legend()
plt.savefig(<span style="color: #228b22;">'images/linefit-1.png'</span>)
</pre>
</div>

<pre class="example">
&gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; [&lt;matplotlib.lines.Line2D object at 0x053C1790&gt;]
[&lt;matplotlib.lines.Line2D object at 0x0313C610&gt;]
&lt;matplotlib.text.Text object at 0x052A4950&gt;
&lt;matplotlib.text.Text object at 0x052B9A10&gt;
&lt;matplotlib.legend.Legend object at 0x053C1CD0&gt;
</pre>

<p><img src="/img/./images/linefit-1.png"><p>
<p>Copyright (C) 2013 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p><p><a href="/org/2013/02/18/Fit-a-line-to-numerical-data.org">org-mode source</a><p>