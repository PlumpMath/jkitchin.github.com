---
title: Colorized text in Emacs
date: 2014/09/14 14:23:05
updated: 2014/09/14 14:23:05
categories: emacs
tags: 
---



<p>
As I continue investigating Emacs + org-mode as a platform for creating applications, it has come up a few times that it would be useful to display colored text. For example, in a summary report of a git repo, you might want to see some information in red, e.g. if you have uncommitted changes, and some information in green, e.g. the repo is clean and consistent with a remote.
</p>

<p>
We can set colors on a string in Emacs like this:
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(propertize <span style="color: #228b22;">"Red Text"</span> 'font-lock-face '(<span style="color: #cd0000;">:foreground</span> <span style="color: #228b22;">"red"</span>))
</pre>
</div>

<p>
The only tricky part is that we need to insert the text into a font-locked buffer to see it. That is also a tad tricky to illustrate in a code block, so here is a way to try it:
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(re-search-forward <span style="color: #228b22;">"-&gt; "</span>)
(insert
  (propertize <span style="color: #228b22;">"Red Text"</span> 'font-lock-face '(<span style="color: #cd0000;">:foreground</span> <span style="color: #228b22;">"red"</span>)))
</pre>
</div>

<p>
-&gt; Red Text
</p>

<p>
The red text does not show in the HTML post, so this is a screenshot of what it looks like in my buffer:
</p>


<div class="figure">
<p><img src="/media/2014-09-14-Colorized-text-in-Emacs/red-text.png"> 
</p>
</div>

<p>
Now, here is how we might use this in a summary report. Say we have a git repo, and we want to know various facts about it. We can get information about tracked/ untracked and modified files like this:
</p>

<div class="org-src-container">

<pre class="src src-sh">git status --porcelain
</pre>
</div>
<pre class="example">
 M _blog/blog.html
 M _blog/blog.org
A  _blog/images/red-text.png
</pre>

<p>
This shows we have two tracked, but modified files, and on added but not committed file. We can use this code to show if we have any untracked files.
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #8b0000;">let</span> ((n 0) s)
  (<span style="color: #8b0000;">dolist</span> (line (split-string
                 (shell-command-to-string <span style="color: #228b22;">"git status --porcelain"</span>)
                 <span style="color: #228b22;">"\n"</span>))
    (<span style="color: #8b0000;">when</span> (string-match <span style="color: #228b22;">"^\\?\\?"</span> line)
      (setq n (+ 1 n))))
  (<span style="color: #8b0000;">if</span> (&gt; n 0)
      (setq s (propertize (format <span style="color: #228b22;">"%s untracked files"</span> n)
                          'font-lock-face '(<span style="color: #cd0000;">:foreground</span> <span style="color: #228b22;">"red"</span>)))
    (setq s (propertize <span style="color: #228b22;">"No untracked files"</span> 
                        'font-lock-face '(<span style="color: #cd0000;">:foreground</span> <span style="color: #228b22;">"forest green"</span>))))
  (re-search-forward <span style="color: #228b22;">"-&gt;"</span>)
  (insert s))
</pre>
</div>

<p>
-&gt;No untracked files
</p>

<p>
In HTML (i.e. the blog post) you cannot really see the green text, so here is a screenshot illustrating it.
<img src="/media/2014-09-14-Colorized-text-in-Emacs/git-untracked-files.png"> 
</p>

<p>
Similarly, we can check for modified files. We add a wrinkle and add a tooltip like text that shows the output of the git command.
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #8b0000;">let</span> ((n 0)
      (output (shell-command-to-string <span style="color: #228b22;">"git status --porcelain"</span>))
      s)
  (<span style="color: #8b0000;">dolist</span> (line (split-string
                 output
                 <span style="color: #228b22;">"\n"</span>))
    (<span style="color: #8b0000;">when</span> (string-match <span style="color: #228b22;">"^ M"</span> line)
      (setq n (+ 1 n))))
  (<span style="color: #8b0000;">if</span> (&gt; n 0)
      (setq s (propertize (format <span style="color: #228b22;">"%s modified files"</span> n)
                          'help-echo output
                          'font-lock-face '(<span style="color: #cd0000;">:foreground</span> <span style="color: #228b22;">"red"</span>)))
    (setq s (propertize <span style="color: #228b22;">"No modified files"</span> 
                        'font-lock-face '(<span style="color: #cd0000;">:foreground</span> <span style="color: #228b22;">"forest green"</span>))))
  (re-search-forward <span style="color: #228b22;">"-&gt; "</span>)
  (insert s))
</pre>
</div>

<p>
-&gt; 2 modified files
</p>

<p>
That looks like this in emacs:
</p>


<div class="figure">
<p><img src="/media/2014-09-14-Colorized-text-in-Emacs/git-modified.png"> 
</p>
</div>


<p>
That is the main idea in this post. You can create strings with properties, and use code to determine what they e.g. what color the text is, etc&#x2026; There are lots of properties listed at <a href="http://www.gnu.org/software/emacs/manual/html_node/elisp/Special-Properties.html">http://www.gnu.org/software/emacs/manual/html_node/elisp/Special-Properties.html</a> that might be helpful in an application. Here are some previous posts that examined similar ideas.
</p>

<ul class="org-ul">
<li>Read-only text <a href="http://kitchingroup.cheme.cmu.edu/blog/2014/09/13/Make-some-org-sections-read-only/">http://kitchingroup.cheme.cmu.edu/blog/2014/09/13/Make-some-org-sections-read-only/</a> 
</li>

<li>Invisible text (this is not exactly a property, but it is similar)
</li>
</ul>
<p>
<a href="http://kitchingroup.cheme.cmu.edu/blog/2014/02/06/Invisible-text-in-emacs/">http://kitchingroup.cheme.cmu.edu/blog/2014/02/06/Invisible-text-in-emacs/</a> </p>
<p>Copyright (C) 2014 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p><p><a href="/org/2014/09/14/Colorized-text-in-Emacs.org">org-mode source</a><p><p>Org-mode version = 8.2.7c</p>