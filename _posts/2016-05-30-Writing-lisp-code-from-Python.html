---
title: Writing lisp code from Python
date: 2016/05/30 09:26:05
updated: 2016/05/30 09:26:05
categories: python,lisp
tags: 
---



<p>
Some time ago I <a href="http://kitchingroup.cheme.cmu.edu/blog/2015/05/16/Python-data-structures-to-lisp/">wrote about converting python data structures to lisp</a> . I have expanded on that idea to writing lisp programs from Python! The newly expanded code that makes this possible can be found at <a href="https://github.com/jkitchin/pycse/blob/master/pycse/lisp.py">https://github.com/jkitchin/pycse/blob/master/pycse/lisp.py</a> .
</p>

<p>
Here are the simple data types known to pycse.lisp:
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #0000FF;">import</span> pycse.lisp
<span style="color: #0000FF;">import</span> numpy <span style="color: #0000FF;">as</span> np

<span style="color: #0000FF;">print</span>(<span style="color: #008000;">"a string"</span>.lisp)
<span style="color: #BA36A5;">a</span> = 5
<span style="color: #BA36A5;">b</span> = 5.0
<span style="color: #0000FF;">print</span>(a.lisp)
<span style="color: #0000FF;">print</span>(b.lisp)
<span style="color: #0000FF;">print</span>([1, 2, 3].lisp)
<span style="color: #0000FF;">print</span>((1, 2, 3).lisp)
<span style="color: #0000FF;">print</span>({<span style="color: #008000;">'a'</span>: 4}.lisp)
<span style="color: #0000FF;">print</span>(np.array([1, 2, 3]).lisp)
<span style="color: #0000FF;">print</span>(np.array([1.0, 2.0, 3.0]).lisp)
</pre>
</div>

<pre class="example">
"a string"
5
5.0
(1 2 3)
(1 2 3)
(:a 4)
(1 2 3)
(1.0 2.0 3.0)
</pre>

<p>
There are also some more complex types.
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #0000FF;">import</span> pycse.lisp <span style="color: #0000FF;">as</span> pl

<span style="color: #0000FF;">print</span>(pl.Symbol(<span style="color: #008000;">'lambda'</span>))
<span style="color: #0000FF;">print</span>(pl.Quote(<span style="color: #008000;">'lambda'</span>))
<span style="color: #0000FF;">print</span>(pl.SharpQuote(<span style="color: #008000;">'lambda'</span>))
<span style="color: #0000FF;">print</span>(pl.Cons(<span style="color: #008000;">"a"</span>, 5))
<span style="color: #0000FF;">print</span>(pl.Alist([<span style="color: #008000;">"a"</span>, 2, <span style="color: #008000;">"b"</span>, 5]))
<span style="color: #0000FF;">print</span>(pl.Vector([1, 2, 3]))
</pre>
</div>

<pre class="example">
lambda
'lambda
#'lambda
("a" . 5)
(("a" . 2) ("b" . 5))
[1 2 3]
</pre>

<p>
You can nest these too.
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #0000FF;">import</span> pycse.lisp <span style="color: #0000FF;">as</span> pl
<span style="color: #0000FF;">print</span>(pl.Quote(pl.Alist([<span style="color: #008000;">"a"</span>, 2, <span style="color: #008000;">"b"</span>, 5])))
</pre>
</div>

<pre class="example">
'(("a" . 2) ("b" . 5))
</pre>

<p>
All that means we can use Python <i>code</i> to generate lisp programs. Here is an example where we make two sub-programs, and combine them into an overall program, then add one more subprogram to it. We wrap the results in an emacs-lisp block, then actually run the block!
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #0000FF;">import</span> pycse.lisp <span style="color: #0000FF;">as</span> pl

<span style="color: #BA36A5;">p1</span> = [pl.Symbol(<span style="color: #008000;">'mapcar'</span>),
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #9B9B9B; background-color: #EDEDED;"> </span> [pl.Symbol(<span style="color: #008000;">'lambda'</span>),
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #9B9B9B; background-color: #EDEDED;"> </span>  [pl.Symbol(<span style="color: #008000;">'x'</span>)],
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #9B9B9B; background-color: #EDEDED;"> </span>  [pl.Symbol(<span style="color: #008000;">'*'</span>),
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   pl.Symbol(<span style="color: #008000;">'x'</span>),
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   pl.Symbol(<span style="color: #008000;">'x'</span>)]],
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #9B9B9B; background-color: #EDEDED;"> </span> pl.Quote([1, 2, 3, 4])]

<span style="color: #BA36A5;">p2</span> = [pl.Symbol(<span style="color: #008000;">'princ'</span>), <span style="color: #008000;">"Hello world"</span>]

<span style="color: #BA36A5;">p</span> = [pl.Symbol(<span style="color: #008000;">'list'</span>), p1, p2]
p.append([pl.Symbol(<span style="color: #008000;">'+'</span>), 5, 5])

<span style="color: #0000FF;">print</span>(p.lisp)
</pre>
</div>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(list (mapcar (<span style="color: #0000FF;">lambda</span> (x) (* x x)) '(1 2 3 4)) (princ <span style="color: #008000;">"Hello world"</span>) (+ 5 5))
</pre>
</div>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="left" />

<col  class="left" />

<col  class="right" />
</colgroup>
<tbody>
<tr>
<td class="left">(1 4 9 16)</td>
<td class="left">Hello world</td>
<td class="right">10</td>
</tr>
</tbody>
</table>

<p>
Wow, it worked! I am not too sure where this will be super useful, but it is an interesting proof of concept. I haven't tested this much beyond the original post and this one. Let me know if you find issues with it.
</p>
<p>Copyright (C) 2016 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p>
<p><a href="/org/2016/05/30/Writing-lisp-code-from-Python.org">org-mode source</a></p>
<p>Org-mode version = 8.2.10</p>