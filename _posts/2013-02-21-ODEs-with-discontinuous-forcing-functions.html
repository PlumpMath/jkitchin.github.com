---
title: ODEs with discontinuous forcing functions
date: 2013/02/21 09:00:00
updated: 2013/02/27 14:28:38
categories: ODE
---


<p>
<a href="http://matlab.cheme.cmu.edu/2011/09/01/odes-with-discontinuous-forcing-functions/" >Matlab post</a>
</p>

<p>
Adapted from <a href="http://archives.math.utk.edu/ICTCM/VOL18/S046/paper.pdf" >http://archives.math.utk.edu/ICTCM/VOL18/S046/paper.pdf</a>
</p>

<p>
A mixing tank initially contains 300 g of salt mixed into 1000 L of water. At t=0 min, a solution of 4 g/L salt enters the tank at 6 L/min. At t=10 min, the solution is changed to 2 g/L salt, still entering at 6 L/min. The tank is well stirred, and the tank solution leaves at a rate of 6 L/min. Plot the concentration of salt (g/L) in the tank as a function of time.
</p>

<p>
A mass balance on the salt in the tank leads to this differential equation: \(\frac{dM_S}{dt} = \nu C_{S,in}(t) - \nu M_S/V\) with the initial condition that \(M_S(t=0)=300\). The wrinkle is that the inlet conditions are not constant.
</p>

<p>
$$C_{S,in}(t) = \begin{array}{ll} 0 & t \le 0, \\ 4 & 0 < t \le 10, \\ 2 & t > 10. \end{array}$$
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">import</span> numpy <span style="color: #8b0000;">as</span> np
<span style="color: #8b0000;">from</span> scipy.integrate <span style="color: #8b0000;">import</span> odeint
<span style="color: #8b0000;">import</span> matplotlib.pyplot <span style="color: #8b0000;">as</span> plt

V = 1000.0 <span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">L</span>
nu = 6.0  <span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">L/min</span>
    
<span style="color: #8b0000;">def</span> <span style="color: #8b2323;">Cs_in</span>(t):
    <span style="color: #228b22;">'inlet concentration'</span>
    <span style="color: #8b0000;">if</span> t &lt; 0:
        Cs = 0.0 <span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">g/L</span>
    <span style="color: #8b0000;">elif</span> (t &gt; 0) <span style="color: #8b0000;">and</span> (t &lt;= 10):
        Cs = 4.0
    <span style="color: #8b0000;">else:</span>
        Cs = 2.0
    <span style="color: #8b0000;">return</span> Cs

<span style="color: #8b0000;">def</span> <span style="color: #8b2323;">mass_balance</span>(Ms, t):
    <span style="color: #228b22;">'$\frac{dM_S}{dt} = \nu C_{S,in}(t) - \nu M_S/V$'</span>
    dMsdt = nu * Cs_in(t) - nu * Ms / V
    <span style="color: #8b0000;">return</span> dMsdt

tspan = np.linspace(0.0, 15.0, 50)

M0 = 300.0 <span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">gm salt</span>
Ms = odeint(mass_balance, M0, tspan)

plt.plot(tspan, Ms/V, <span style="color: #228b22;">'b.-'</span>)
plt.xlabel(<span style="color: #228b22;">'Time (min)'</span>)
plt.ylabel(<span style="color: #228b22;">'Salt concentration (g/L)'</span>)
plt.savefig(<span style="color: #228b22;">'images/ode-discont.png'</span>)
</pre>
</div>

<p><img src="/img/./images/ode-discont.png"><p>

<p>
You can see the discontinuity in the salt concentration at 10 minutes due to the discontinous change in the entering salt concentration.
</p>
<p>Copyright (C) 2013 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p><p><a href="/org/2013/02/21/ODEs-with-discontinuous-forcing-functions.org">org-mode source</a><p>