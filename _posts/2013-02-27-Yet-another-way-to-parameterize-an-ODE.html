---
title: Yet another way to parameterize an ODE
date: 2013/02/27 14:31:44
updated: 2013/02/27 14:31:44
categories: ODE
---


<p>
<a href="http://matlab.cheme.cmu.edu/2011/11/06/yet-another-way-to-parameterize-an-ode/" >Matlab post</a>

We previously examined a way to parameterize an ODE. In those methods, we either used an anonymous function to parameterize an ode function, or we used a nested function that used variables from the shared workspace.
</p>

<p>
We want a convenient way to solve \(dCa/dt = -k Ca\) for multiple values of \(k\). Here we use a trick to pass a parameter to an ODE through the initial conditions. We expand the ode function definition to include this parameter, and set its derivative to zero, effectively making it a constant.
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">import</span> numpy <span style="color: #8b0000;">as</span> np
<span style="color: #8b0000;">from</span> scipy.integrate <span style="color: #8b0000;">import</span> odeint
<span style="color: #8b0000;">import</span> matplotlib.pyplot <span style="color: #8b0000;">as</span> plt

<span style="color: #8b0000;">def</span> <span style="color: #8b2323;">ode</span>(F, t):
    Ca, k = F
    dCadt = -k * Ca
    dkdt = 0.0
    <span style="color: #8b0000;">return</span> [dCadt, dkdt]

tspan = np.linspace(0, 4)

Ca0 = 1;
K = [2.0, 3.0]
<span style="color: #8b0000;">for</span> k <span style="color: #8b0000;">in</span> K:
    F = odeint(ode, [Ca0, k], tspan)
    Ca = F[:,0]
    plt.plot(tspan, Ca, label=<span style="color: #228b22;">'k={0}'</span>.format(k))
plt.xlabel(<span style="color: #228b22;">'time'</span>)
plt.ylabel(<span style="color: #228b22;">'$C_A$'</span>)
plt.legend(loc=<span style="color: #228b22;">'best'</span>)
plt.savefig(<span style="color: #228b22;">'images/ode-parameterized-1.png'</span>)
plt.show()
</pre>
</div>

<p><img src="/img/./images/ode-parameterized-1.png"><p>

<p>
I do not think this is a very elegant way to pass parameters around compared to the previous methods, but it nicely illustrates that there is more than one way to do it. And who knows, maybe it will be useful in some other context one day!
</p>
<p>Copyright (C) 2013 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p><p><a href="/org/2013/02/27/Yet-another-way-to-parameterize-an-ODE.org">org-mode source</a><p>