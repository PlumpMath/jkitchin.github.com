---
title: Parameter estimation by directly minimizing summed squared errors
date: 2013/02/18 09:00:00
updated: 2013/02/27 14:41:54
categories: data analysis
---


<p>
<a href="http://matlab.cheme.cmu.edu/2011/10/10/nonlinearfit_minsse-m/" >Matlab post</a>
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">import</span> numpy <span style="color: #8b0000;">as</span> np
<span style="color: #8b0000;">import</span> matplotlib.pyplot <span style="color: #8b0000;">as</span> plt

x = np.array([0.0,       1.1,       2.3,      3.1,       4.05,      6.0])
y = np.array([0.0039,    1.2270,    5.7035,   10.6472,   18.6032,   42.3024])

plt.plot(x, y)
plt.xlabel(<span style="color: #228b22;">'x'</span>)
plt.ylabel(<span style="color: #228b22;">'y'</span>)
plt.savefig(<span style="color: #228b22;">'images/nonlin-minsse-1.png'</span>)
</pre>
</div>

<pre class="example">
&gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; [&lt;matplotlib.lines.Line2D object at 0x000000000733D898&gt;]
&lt;matplotlib.text.Text object at 0x00000000071EC5C0&gt;
&lt;matplotlib.text.Text object at 0x00000000071EED30&gt;
</pre>

<p><img src="/img/./images/nonlin-minsse-1.png"><p>

<p>
We are going to fit the function \(y = x^a\) to the data. The best \(a\) will minimize the summed squared error between the model and the fit. 
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">def</span> <span style="color: #8b2323;">errfunc_</span>(a):
    <span style="color: #8b0000;">return</span> np.sum((y - x**a)**2)

errfunc = np.vectorize(errfunc_)

arange = np.linspace(1, 3)
sse = errfunc(arange)

plt.figure()
plt.plot(arange, sse)
plt.xlabel(<span style="color: #228b22;">'a'</span>)
plt.ylabel(<span style="color: #228b22;">'$\Sigma (y - y_{pred})^2$'</span>)
plt.savefig(<span style="color: #228b22;">'images/nonlin-minsse-2.png'</span>)
</pre>
</div>

<pre class="example">
... &gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; &lt;matplotlib.figure.Figure object at 0x000000000736DBA8&gt;
[&lt;matplotlib.lines.Line2D object at 0x00000000075CBEF0&gt;]
&lt;matplotlib.text.Text object at 0x00000000076B8C18&gt;
&lt;matplotlib.text.Text object at 0x0000000007698BE0&gt;
</pre>

<p><img src="/img/./images/nonlin-minsse-2.png"><p>

<p>
Based on the graph above, you can see a minimum in the summed squared error near \(a = 2.1\). We use that as our initial guess. Since we know the answer is bounded, we use scipy.optimize.fminbound
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">from</span> scipy.optimize <span style="color: #8b0000;">import</span> fminbound

amin = fminbound(errfunc, 1.0, 3.0)

<span style="color: #8b0000;">print</span> amin

plt.figure()
plt.plot(x, y, <span style="color: #228b22;">'bo'</span>, label=<span style="color: #228b22;">'data'</span>)
plt.plot(x, x**amin, <span style="color: #228b22;">'r-'</span>, label=<span style="color: #228b22;">'fit'</span>)
plt.xlabel(<span style="color: #228b22;">'x'</span>)
plt.ylabel(<span style="color: #228b22;">'y'</span>)
plt.legend(loc=<span style="color: #228b22;">'best'</span>)
plt.savefig(<span style="color: #228b22;">'images/nonlin-minsse-3.png'</span>)
</pre>
</div>

<pre class="example">
&gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; 2.09004838933
&gt;&gt;&gt; &lt;matplotlib.figure.Figure object at 0x00000000075D8470&gt;
[&lt;matplotlib.lines.Line2D object at 0x0000000007BDFA20&gt;]
[&lt;matplotlib.lines.Line2D object at 0x0000000007BDFC18&gt;]
&lt;matplotlib.text.Text object at 0x0000000007BC6828&gt;
&lt;matplotlib.text.Text object at 0x0000000007BCAF98&gt;
&lt;matplotlib.legend.Legend object at 0x0000000007BE3128&gt;
</pre>

<p><img src="/img/./images/nonlin-minsse-3.png"><p>

<p>
We can do nonlinear fitting by directly minimizing the summed squared error between a model and data. This method lacks some of the features of other methods, notably the simple ability to get the confidence interval. However, this method is flexible and may offer more insight into how the solution depends on the parameters. </p>
<p>Copyright (C) 2013 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p><p><a href="/org/2013/02/18/Parameter-estimation-by-directly-minimizing-summed-squared-errors.org">org-mode source</a><p>