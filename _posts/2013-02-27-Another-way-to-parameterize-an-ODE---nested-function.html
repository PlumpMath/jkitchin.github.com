---
title: Another way to parameterize an ODE - nested function
date: 2013/02/27 14:31:51
updated: 2013/02/27 14:32:05
categories: ODE
---


<p>
<a href="http://matlab.cheme.cmu.edu/2011/09/18/another-way-to-parameterize-an-ode-nested-function/" >Matlab post</a>

We saw one method to parameterize an ODE, by creating an ode function that takes an extra parameter argument, and then making a function handle that has the syntax required for the solver, and passes the parameter the ode function. 
</p>

<p>
Here we define the ODE function in a loop. Since the nested function is in the namespace of the main function, it can &ldquo;see&rdquo; the values of the variables in the main function. We will use this method to look at the solution to the van der Pol equation for several different values of mu.
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">import</span> numpy <span style="color: #8b0000;">as</span> np
<span style="color: #8b0000;">from</span> scipy.integrate <span style="color: #8b0000;">import</span> odeint
<span style="color: #8b0000;">import</span> matplotlib.pyplot <span style="color: #8b0000;">as</span> plt

MU = [0.1, 1, 2, 5]
tspan = np.linspace(0, 100, 5000)
Y0 = [0, 3]

<span style="color: #8b0000;">for</span> mu <span style="color: #8b0000;">in</span> MU:
    <span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">define the ODE</span>
    <span style="color: #8b0000;">def</span> <span style="color: #8b2323;">vdpol</span>(Y, t):
        x,y = Y
        dxdt = y
        dydt = -x + mu * (1 - x**2) * y
        <span style="color: #8b0000;">return</span>  [dxdt, dydt]
    
    Y = odeint(vdpol, Y0, tspan)
    
    x = Y[:,0]; y = Y[:,1]
    plt.plot(x, y, label=<span style="color: #228b22;">'mu={0:1.2f}'</span>.format(mu))

plt.axis(<span style="color: #228b22;">'equal'</span>)
plt.legend(loc=<span style="color: #228b22;">'best'</span>)
plt.savefig(<span style="color: #228b22;">'images/ode-nested-parameterization.png'</span>)
plt.show()
</pre>
</div>

<p><img src="/img/./images/ode-nested-parameterization.png"><p>

<p>
You can see the solution changes dramatically for different values of mu. The point here is not to understand why, but to show an easy way to study a parameterize ode with a nested function. Nested functions can be a great way to &ldquo;share&rdquo; variables between functions especially for ODE solving, and nonlinear algebra solving, or any other application where you need a lot of parameters defined in one function in another function.
</p>
<p>Copyright (C) 2013 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p><p><a href="/org/2013/02/27/Another-way-to-parameterize-an-ODE---nested-function.org">org-mode source</a><p>