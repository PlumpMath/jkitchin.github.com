---
title: Finding the maximum power of a photovoltaic device.
date: 2014/04/15 20:38:10
updated: 2016/04/04 11:54:50
categories: python,optimization
tags: 
---



<p>
A photovoltaic device is characterized by a current-voltage relationship. Let us say, for argument's sake, that the relationship is known and defined by
</p>

<p>
\(i = 0.5 - 0.5 * V^2\)
</p>

<p>
The voltage is highest when the current is equal to zero, but of course then you get no power. The current is highest when the voltage is zero, i.e. short-circuited, but there is again no power. We seek the highest power condition, which is to find the maximum of \(i V\). This is a constrained optimization. We solve it by creating an objective function that returns the negative of (\i V\), and then find the minimum.
</p>

<p>
First, let us examine the i-V relationship.
</p>
<div class="org-src-container">

<pre class="src src-python"><span style="color: #0000FF;">import</span> matplotlib.pyplot <span style="color: #0000FF;">as</span> plt
<span style="color: #0000FF;">import</span> numpy <span style="color: #0000FF;">as</span> np

<span style="color: #BA36A5;">V</span> = np.linspace(0, 1)

<span style="color: #0000FF;">def</span> <span style="color: #006699;">i</span>(V):
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #0000FF;">return</span> 0.5 - 0.5 * V**2

plt.figure()
plt.plot(V, i(V))
plt.savefig(<span style="color: #008000;">'images/iV.png'</span>)
</pre>
</div>

<pre class="example">
&lt;matplotlib.figure.Figure object at 0x11193ec18&gt;
[&lt;matplotlib.lines.Line2D object at 0x111d43668&gt;]
</pre>


<div class="figure">
<p><img src="/media/2014-04-15-Finding-the-maximum-power-of-a-photovoltaic-device./iV.png"> 
</p>
</div>


<p>
Now, let us be sure there is a maximum in power.
</p>
<div class="org-src-container">

<pre class="src src-python"><span style="color: #0000FF;">import</span> matplotlib.pyplot <span style="color: #0000FF;">as</span> plt
<span style="color: #0000FF;">import</span> numpy <span style="color: #0000FF;">as</span> np

<span style="color: #BA36A5;">V</span> = np.linspace(0, 1)

<span style="color: #0000FF;">def</span> <span style="color: #006699;">i</span>(V):
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #0000FF;">return</span> 0.5 - 0.5 * V**2

plt.plot(V, i(V) * V)
plt.savefig(<span style="color: #008000;">'images/P1.png'</span>)
</pre>
</div>

<pre class="example">
[&lt;matplotlib.lines.Line2D object at 0x111d437f0&gt;]
</pre>


<div class="figure">
<p><img src="/media/2014-04-15-Finding-the-maximum-power-of-a-photovoltaic-device./P1.png"> 
</p>
</div>

<p>
You can see in fact there is a maximum, near V=0.6. We could solve this problem analytically by taking the appropriate derivative and solving it for zero. That still might require solving a nonlinear problem though. We will directly setup and solve the constrained optimization.
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #0000FF;">from</span> scipy.optimize <span style="color: #0000FF;">import</span> fmin_slsqp
<span style="color: #0000FF;">import</span> numpy <span style="color: #0000FF;">as</span> np
<span style="color: #0000FF;">import</span> matplotlib.pyplot <span style="color: #0000FF;">as</span> plt

<span style="color: #0000FF;">def</span> <span style="color: #006699;">objective</span>(X):
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #BA36A5;">i</span>, <span style="color: #BA36A5;">V</span> = X
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #0000FF;">return</span> - i * V

<span style="color: #0000FF;">def</span> <span style="color: #006699;">eqc</span>(X):
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #036A07;">'equality constraint'</span>
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #BA36A5;">i</span>, <span style="color: #BA36A5;">V</span> = X
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #0000FF;">return</span> (0.5 - 0.5 * V**2) - i

<span style="color: #BA36A5;">X0</span> = [0.2, 0.6]
<span style="color: #BA36A5;">X</span> = fmin_slsqp(objective, X0, eqcons=[eqc])

<span style="color: #BA36A5;">imax</span>, <span style="color: #BA36A5;">Vmax</span> = X


<span style="color: #BA36A5;">V</span> = np.linspace(0, 1)

<span style="color: #0000FF;">def</span> <span style="color: #006699;">i</span>(V):
<span style="color: #9B9B9B; background-color: #EDEDED;"> </span>   <span style="color: #0000FF;">return</span> 0.5 - 0.5 * V**2

plt.plot(V, i(V), Vmax, imax, <span style="color: #008000;">'ro'</span>)
plt.savefig(<span style="color: #008000;">'images/P2.png'</span>)
</pre>
</div>

<pre class="example">
Optimization terminated successfully.    (Exit mode 0)
            Current function value: -0.192450127337
            Iterations: 5
            Function evaluations: 20
            Gradient evaluations: 5
[&lt;matplotlib.lines.Line2D object at 0x111946470&gt;, &lt;matplotlib.lines.Line2D object at 0x11192c518&gt;]
</pre>


<div class="figure">
<p><img src="/media/2014-04-15-Finding-the-maximum-power-of-a-photovoltaic-device./P2.png"> 
</p>
</div>

<p>
You can see the maximum power is approximately 0.2 (unspecified units), at the conditions indicated by the red dot in the figure above.
</p>
<p>Copyright (C) 2016 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p>
<p><a href="/org/2014/04/15/Finding-the-maximum-power-of-a-photovoltaic-device..org">org-mode source</a></p>
<p>Org-mode version = 8.2.10</p>