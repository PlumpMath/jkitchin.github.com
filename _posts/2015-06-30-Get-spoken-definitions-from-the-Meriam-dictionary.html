---
title: Get spoken definitions from the Meriam dictionary
date: 2015/06/30 11:26:41
updated: 2015/06/30 11:26:41
categories: emacs
tags: 
---


<p>
Now that I can get <a href="http://kitchingroup.cheme.cmu.edu/blog/2015/06/29/Getting-Emacs-to-read-to-me/">Emacs to speak words</a> , here is a new application of the idea. We use it to speak the definition of the word at point. We look up the definition here:
<a href="http://www.dictionaryapi.com/account/index.htm">http://www.dictionaryapi.com/account/index.htm</a> 
</p>

<p>
You may want to head straight to the video to see how this works here: <a href="https://www.youtube.com/watch?v=m529gXMrXZA">https://www.youtube.com/watch?v=m529gXMrXZA</a> 
</p>


<p>
I had to get an API key for this. I suppose this key should be secret, but it could only be secure by obscurity in any kind of webapp and I don't anticipate using this much so here are the keys I got for the dictionary and thesaurus.
</p>

<p>
Key (Dictionary): 64f0950a-03b9-4315-9ba5-a73a964251ed
Key (Thesaurus): ff0e39e2-b31f-4f17-833c-24e2875aad5d
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #0000FF;">with-current-buffer</span>
    (url-retrieve-synchronously
     (format
      <span style="color: #008000;">"http://www.dictionaryapi.com/api/v1/references/collegiate/xml/%s?key=%s"</span>
      <span style="color: #008000;">"synchronous"</span>
      <span style="color: #008000;">"64f0950a-03b9-4315-9ba5-a73a964251ed"</span>))
  (buffer-substring url-http-end-of-headers (point-max)))
</pre>
</div>

<pre class="example">
&lt;?xml version="1.0" encoding="utf-8" ?&gt;
&lt;entry_list version="1.0"&gt;
</pre>
<p>
:        &lt;entry id="synchronous"&gt;&lt;ew&gt;synchronous&lt;/ew&gt;&lt;subj&gt;AE-4b#CP-5#TL-5&lt;/subj&gt;&lt;hw&gt;syn*chro*nous&lt;/hw&gt;&lt;sound&gt;&lt;wav&gt;synchr14.wav&lt;/wav&gt;&lt;wpr&gt;!siN-kru-nus&lt;/wpr&gt;&lt;/sound&gt;&lt;pr&gt;ˈsiŋ-krə-nəs, ˈsin-&lt;/pr&gt;&lt;fl&gt;adjective&lt;/fl&gt;&lt;et&gt;Late Latin &lt;it&gt;synchronos,&lt;/it&gt; from Greek, from &lt;it&gt;syn-&lt;/it&gt; + &lt;it&gt;chronos&lt;/it&gt; time&lt;/et&gt;&lt;def&gt;&lt;date&gt;1669&lt;/date&gt; &lt;sn&gt;1&lt;/sn&gt; &lt;dt&gt;:happening, existing, or arising at precisely the same time&lt;/dt&gt; &lt;sn&gt;2&lt;/sn&gt; &lt;dt&gt;:recurring or operating at exactly the same periods&lt;/dt&gt; &lt;sn&gt;3&lt;/sn&gt; &lt;dt&gt;:involving or indicating &lt;fw&gt;synchronism&lt;/fw&gt;&lt;/dt&gt; &lt;sn&gt;4 a&lt;/sn&gt; &lt;dt&gt;:having the same period&lt;/dt&gt; &lt;sd&gt;also&lt;/sd&gt; &lt;dt&gt;:having the same period and phase&lt;/dt&gt;  &lt;sn&gt;b&lt;/sn&gt; &lt;dt&gt;:&lt;sx&gt;geostationary&lt;/sx&gt;&lt;/dt&gt; &lt;sn&gt;5&lt;/sn&gt; &lt;dt&gt;:of, used in, or being digital communication (as between computers) in which a common timing signal is established that dictates when individual bits can be transmitted and which allows for very high rates of data transfer&lt;/dt&gt;&lt;ss&gt;contemporary&lt;/ss&gt;&lt;/def&gt;&lt;uro&gt;&lt;ure&gt;syn*chro*nous*ly&lt;/ure&gt; &lt;fl&gt;adverb&lt;/fl&gt;&lt;/uro&gt;&lt;uro&gt;&lt;ure&gt;syn*chro*nous*ness&lt;/ure&gt; &lt;fl&gt;noun&lt;/fl&gt;&lt;/uro&gt;&lt;/entry&gt;
:        &lt;entry id="synchronous motor"&gt;&lt;ew&gt;synchronous motor&lt;/ew&gt;&lt;subj&gt;ME#EE&lt;/subj&gt;&lt;hw&gt;synchronous motor&lt;/hw&gt;&lt;fl&gt;noun&lt;/fl&gt;&lt;def&gt;&lt;date&gt;1897&lt;/date&gt;&lt;dt&gt;:an electric motor having a speed strictly proportional to the frequency of the operating current&lt;/dt&gt;&lt;/def&gt;&lt;/entry&gt;
</p>
<pre class="example">
&lt;/entry_list&gt;
</pre>

<p>
The idea is to query the url, get some xml back, and collect the definitions from it. Then, construct a string of the word, the number of definitions, then the definitions, and say it.
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #0000FF;">defun</span> <span style="color: #006699;">speak-definition</span> ()
  (<span style="color: #0000FF;">interactive</span>)
  (<span style="color: #0000FF;">let*</span> ((keyword (thing-at-point 'word))
         (api-key <span style="color: #008000;">"64f0950a-03b9-4315-9ba5-a73a964251ed"</span>)
         (xml (<span style="color: #0000FF;">with-current-buffer</span>
                  (url-retrieve-synchronously
                   (format
                    <span style="color: #008000;">"http://www.dictionaryapi.com/api/v1/references/collegiate/xml/%s?key=%s"</span>
                    keyword
                    api-key))
                (xml-parse-region url-http-end-of-headers (point-max))))
         (entries (xml-get-children (car xml) 'entry))
         (nentries (length entries))
         (defs (<span style="color: #0000FF;">loop</span> for entry in entries
                     collect (car (xml-get-children entry 'def))))
         (definition (format
                      <span style="color: #008000;">"%s"</span>
                      (concat
                       (format <span style="color: #008000;">"%s has %s definition%s. "</span>
                               keyword
                               nentries
                               (<span style="color: #0000FF;">if</span> (<span style="color: #0000FF;">or</span> (= 0 nentries)
                                       (&gt; nentries 1))
                                   <span style="color: #008000;">"s"</span>
                                 <span style="color: #008000;">""</span>))
                       (mapconcat
                        'identity
                        (<span style="color: #0000FF;">loop</span> for element in
                              (<span style="color: #0000FF;">loop</span> for def in defs
                                    collect (car (xml-get-children def 'dt)))
                              for i from 1
                              collect (format <span style="color: #008000;">"%s %s"</span> i (car (xml-node-children element))))
                        <span style="color: #008000;">" "</span>)))))
    (message definition)
    (do-applescript
     (format
      <span style="color: #008000;">"say \"%s\""</span> definition))))
</pre>
</div>

<pre class="example">
speak-definition
</pre>

<p>
Let us try this out on a few words: asynchronous  synchronous  flibbity
</p>

<p>
I guess this would be helpful sometimes ;)
</p>
<p>Copyright (C) 2015 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p><p><a href="/org/2015/06/30/Get-spoken-definitions-from-the-Meriam-dictionary.org">org-mode source</a><p><p>Org-mode version = 8.2.10</p>