---
title: Context-specific org-mode speed keys
date: 2016/12/22 13:18:06
updated: 2016/12/22 13:18:06
categories: emacs,orgmode
tags: 
---


<p>
I have been using org-mode to make a contact database. A contact is basically just a headline with an EMAIL property, e.g. <a href="https://julien.danjou.info/projects/emacs-packages#org-contacts">https://julien.danjou.info/projects/emacs-packages#org-contacts</a>.  I thought it would be nice to have an org-mode speed key so that if I was at the beginning of a contact headline, I could just press "e" to open an email buffer to that contact. This might generally be useful to have different speed keys that serve different purposes or are only defined on specific types of headlines.
</p>

<p>
Org-mode already had this feature in mind for speed keys. All you have to do is define the list of speed keys and their functions, provide a function that picks the right one, and add it to the org-speed-command-hook. Here is the code that makes this possible. This defines "c" to copy the email to the clipboard, "e" to email the contact, and "m" to copy a "name &lt;email&gt;" string to the clipboard, but only when you are on a headline with an EMAIL property. If there is not a contact specific speed key defined, then a user-defined speed key or a default key will be used if it is defined. In case I do not remember the keys, "?" will show them to me. It is small hack, but if you end up using the contact headlines for much, it might be really helpful as an alternative to M-x some-contacts-command.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #0000FF;">setq</span> org-speed-commands-contacts
      '((<span style="color: #008000;">"c"</span> . (<span style="color: #0000FF;">lambda</span> ()
                 <span style="color: #036A07;">"Copy the email address to the clipboard."</span>
                 (message (kill-new (org-entry-get (point) <span style="color: #008000;">"EMAIL"</span>)))))
        (<span style="color: #008000;">"e"</span> . (<span style="color: #0000FF;">lambda</span> ()
                 <span style="color: #036A07;">"Send an email to the contact."</span>
                 (<span style="color: #0000FF;">let</span> ((email (org-entry-get (point) <span style="color: #008000;">"EMAIL"</span>)))
                   (compose-mail)
                   (message-goto-to)
                   (insert email)
                   (message-goto-subject)))) 
        (<span style="color: #008000;">"m"</span> . (<span style="color: #0000FF;">lambda</span> ()
                 <span style="color: #036A07;">"Copy \"name &lt;email&gt;\""</span>
                 (message (kill-new
                           (format <span style="color: #008000;">"%s &lt;%s&gt;"</span>
                                   (nth 4 (org-heading-components))
                                   (org-entry-get (point) <span style="color: #008000;">"EMAIL"</span>))))))
        (<span style="color: #008000;">"?"</span> . (<span style="color: #0000FF;">lambda</span> ()
                 <span style="color: #036A07;">"Print contacts speed key help."</span>
                 (<span style="color: #0000FF;">with-output-to-temp-buffer</span> <span style="color: #008000;">"*Help*"</span>
                   (princ <span style="color: #008000;">"Contacts Speed commands\n===========================\n"</span>)
                   (mapc #'org-print-speed-command org-speed-commands-contacts)
                   (princ <span style="color: #008000;">"\n"</span>)
                   (princ <span style="color: #008000;">"User-defined Speed commands\n===========================\n"</span>)
                   (mapc #'org-print-speed-command org-speed-commands-user)
                   (princ <span style="color: #008000;">"Built-in Speed commands\n=======================\n"</span>)
                   (mapc #'org-print-speed-command org-speed-commands-default))
                 (<span style="color: #0000FF;">with-current-buffer</span> <span style="color: #008000;">"*Help*"</span>
                   (<span style="color: #0000FF;">setq</span> truncate-lines t))))))

(<span style="color: #0000FF;">defun</span> <span style="color: #006699;">org-speed-contacts</span> (keys)
  (<span style="color: #0000FF;">when</span> (<span style="color: #0000FF;">and</span> (bolp) (looking-at org-outline-regexp)
             (not (null (org-entry-get (point) <span style="color: #008000;">"EMAIL"</span>))))
    (cdr (assoc keys org-speed-commands-contacts))))

(add-hook 'org-speed-command-hook 'org-speed-contacts)
</pre>
</div>
<p>Copyright (C) 2016 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p>
<p><a href="/org/2016/12/22/Context-specific-org-mode-speed-keys.org">org-mode source</a></p>
<p>Org-mode version = 9.0</p>