---
title: Interacting with Excel in python
date: 2013/03/08 14:39:29
updated: 2013/03/08 14:39:29
categories: programming
tags: 
---


<p>
<a href="http://matlab.cheme.cmu.edu/2011/08/07/manipulating-excel-with-matlab/" >Matlab post</a>
</p>

<p>
There will be times it is convenient to either read data from Excel, or write data to Excel. This is possible in python (<a href="http://www.python-excel.org/" >http://www.python-excel.org/</a>). You may also look at (<a href="https://bitbucket.org/ericgazoni/openpyxl/wiki/Home" >https://bitbucket.org/ericgazoni/openpyxl/wiki/Home</a>).
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">import</span> xlrd

wb = xlrd.open_workbook(<span style="color: #228b22;">'data/example.xlsx'</span>)
sh1 = wb.sheet_by_name(u<span style="color: #228b22;">'Sheet1'</span>)

<span style="color: #8b0000;">print</span> sh1.col_values(0)  <span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">column 0</span>
<span style="color: #8b0000;">print</span> sh1.col_values(1)  <span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">column 1</span>

sh2 = wb.sheet_by_name(u<span style="color: #228b22;">'Sheet2'</span>)

x = sh2.col_values(0)  <span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">column 0</span>
y = sh2.col_values(1)  <span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">column 1</span>

<span style="color: #8b0000;">import</span> matplotlib.pyplot <span style="color: #8b0000;">as</span> plt
plt.plot(x, y)
plt.savefig(<span style="color: #228b22;">'images/excel-1.png'</span>)
</pre>
</div>

<pre class="example">
[u'value', u'function']
[2.0, 3.0]
</pre>

<p><img src="/img/./images/excel-1.png"><p>

<div id="outline-container-1" class="outline-2">
<h2 id="sec-1"><span class="section-number-2">1</span> Writing Excel workbooks</h2>
<div class="outline-text-2" id="text-1">
<p>
Writing data to Excel sheets is pretty easy. Note, however, that this overwrites the worksheet if it already exists.
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">import</span> xlwt
<span style="color: #8b0000;">import</span> numpy <span style="color: #8b0000;">as</span> np

x = np.linspace(0, 2)
y = np.sqrt(x)

<span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">save the data</span>
book = xlwt.Workbook()

sheet1 = book.add_sheet(<span style="color: #228b22;">'Sheet 1'</span>)

<span style="color: #8b0000;">for</span> i <span style="color: #8b0000;">in</span> <span style="color: #8b0000;">range</span>(len(x)):
    sheet1.write(i, 0, x[i])
    sheet1.write(i, 1, y[i])

book.save(<span style="color: #228b22;">'data/example2.xls'</span>) <span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">maybe can only write .xls format</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-2" class="outline-2">
<h2 id="sec-2"><span class="section-number-2">2</span> Updating an existing Excel workbook</h2>
<div class="outline-text-2" id="text-2">
<p>
It turns out you have to make a copy of an existing workbook, modify the copy and then write out the results using the <code>xlwt</code> module.
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">from</span> xlrd <span style="color: #8b0000;">import</span> open_workbook

<span style="color: #8b0000;">from</span> xlutils.copy <span style="color: #8b0000;">import</span> copy

rb = open_workbook(<span style="color: #228b22;">'data/example2.xls'</span>,formatting_info=<span style="color: #8b0000;">True</span>)
rs = rb.sheet_by_index(0)

wb = copy(rb)

ws = wb.add_sheet(<span style="color: #228b22;">'Sheet 2'</span>)
ws.write(0, 0, <span style="color: #228b22;">"Appended"</span>)

wb.save(<span style="color: #228b22;">'data/example2.xls'</span>)
</pre>
</div>
</div>
</div>
<div id="outline-container-3" class="outline-2">
<h2 id="sec-3"><span class="section-number-2">3</span> Summary</h2>
<div class="outline-text-2" id="text-3">
<p>
Matlab has better support for interacting with Excel than python does right now. You could get better Excel interaction via COM, but that is Windows specific, and requires you to have Excel installed on your computer. 
If you only need to read or write data, then xlrd/xlwt or the openpyxl modules will server you well.
</p>
</div>
</div>
<p>Copyright (C) 2013 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p><p><a href="/org/2013/03/08/Interacting-with-Excel-in-python.org">org-mode source</a><p>