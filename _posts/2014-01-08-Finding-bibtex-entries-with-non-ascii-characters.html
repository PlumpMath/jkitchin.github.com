---
title: Finding bibtex entries with non-ascii characters
date: 2014/01/08 09:49:39
updated: 2014/01/08 09:49:39
categories: bibtex
tags: 
---


<p>
I have found that some journals cannot handle bibtex entries with non-ascii characters in them. Unfortunately, when you paste bibtex entries into your reference file from the web, there are often non-ascii characters in them. Emacs usually shows those characters just fine, so it is difficult to find them. Here is a little recipe to go through each entry to find entries with non-ascii characters. These range from accented characters, greek letters, degree symbols, dashes, fancy quotes, etc&#x2026; Since they are hard to see by eye, we can let Emacs find them for us, and then replace them with the corresponding ascii LaTeX commands. 
</p>

<p>
I found a function to find non-ascii characters here: <a href="http://www.emacswiki.org/emacs/FindingNonAsciiCharacters">http://www.emacswiki.org/emacs/FindingNonAsciiCharacters</a> . Now, we use a modified version of this on each entry in a bibtex file. If we find a character, we will print an org-mode link to make it easy to get right to the entry.
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #8b0000;">defun</span> <span style="color: #8b2323;">contains-non-ascii-char-p</span> ()
  <span style="color: #228b22;">"tests if buffer contains non-ascii character"</span>
  (interactive)
  (<span style="color: #8b0000;">let</span> (point)
    (<span style="color: #8b0000;">save-excursion</span>
      (setq point
            (<span style="color: #8b0000;">catch</span> '<span style="color: #cd0000;">non-ascii</span>
              (<span style="color: #8b0000;">while</span> (not (eobp))
                (or (eq (char-charset (following-char))
                        'ascii)
                    (<span style="color: #8b0000;">throw</span> '<span style="color: #cd0000;">non-ascii</span> (point)))
                (forward-char 1)))))
    (<span style="color: #8b0000;">if</span> point
        (goto-char point)
      nil)))


(find-file <span style="color: #228b22;">"~/Dropbox/bibliography/references.bib"</span>)
(bibtex-map-entries (<span style="color: #8b0000;">lambda</span> (bibtex-key start end)                        
                      (<span style="color: #8b0000;">save-restriction</span>
                        <span style="color: #ff0000; font-weight: bold;">;; </span><span style="color: #ff0000; font-weight: bold;">narrow so we only look at this entry. save-restriction will rewiden</span>
                        (bibtex-narrow-to-entry)
                        (<span style="color: #8b0000;">when</span> (contains-non-ascii-char-p) (princ (format <span style="color: #228b22;">"cite:%s"</span> bibtex-key)))))))
</pre>
</div>

<pre class="example">
cite:suntivich-2011-perov-oxide
</pre>

<p>
You can see I only had one reference in that file with a non-ascii character. I think it is best practice to replace these with pure LaTeX commands. See <a href="http://en.wikibooks.org/wiki/LaTeX/Special_Characters">http://en.wikibooks.org/wiki/LaTeX/Special_Characters</a> for a good reference on what commands are used for the accented characters.
</p>
<p>Copyright (C) 2014 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p><p><a href="/org/2014/01/08/Finding-bibtex-entries-with-non-ascii-characters.org">org-mode source</a><p>