---
title: Interpolation with splines
date: 2013/02/27 14:43:07
updated: 2013/02/27 14:43:07
categories: interpolation
---


<p>
When you do not know the functional form of data to fit an equation, you can still fit/interpolate with splines.
</p>
<div class="org-src-container">

<pre class="src src-python"><span style="color: #ff0000; font-weight: bold;"># use splines to fit and interpolate data</span>
<span style="color: #8b0000;">from</span> scipy.interpolate <span style="color: #8b0000;">import</span> interp1d
<span style="color: #8b0000;">from</span> scipy.optimize <span style="color: #8b0000;">import</span> fmin
<span style="color: #8b0000;">import</span> numpy <span style="color: #8b0000;">as</span> np
<span style="color: #8b0000;">import</span> matplotlib.pyplot <span style="color: #8b0000;">as</span> plt

x = np.array([ 0,      1,      2,      3,      4    ])
y = np.array([ 0.,     0.308,  0.55,   0.546,  0.44 ])

<span style="color: #ff0000; font-weight: bold;"># create the interpolating function</span>
f = interp1d(x, y, kind=<span style="color: #228b22;">'cubic'</span>, bounds_error=<span style="color: #8b0000;">False</span>)

<span style="color: #ff0000; font-weight: bold;"># to find the maximum, we minimize the negative of the function. We</span>
<span style="color: #ff0000; font-weight: bold;"># cannot just multiply f by -1, so we create a new function here.</span>
f2 = interp1d(x, -y, kind=<span style="color: #228b22;">'cubic'</span>)
xmax = fmin(f2, 2.5)

xfit = np.linspace(0,4)

plt.plot(x,y,<span style="color: #228b22;">'bo'</span>)
plt.plot(xfit, f(xfit),<span style="color: #228b22;">'r-'</span>)
plt.plot(xmax, f(xmax),<span style="color: #228b22;">'g*'</span>)
plt.legend([<span style="color: #228b22;">'data'</span>,<span style="color: #228b22;">'fit'</span>,<span style="color: #228b22;">'max'</span>], loc=<span style="color: #228b22;">'best'</span>, numpoints=1)
plt.xlabel(<span style="color: #228b22;">'x data'</span>)
plt.ylabel(<span style="color: #228b22;">'y data'</span>)
plt.title(<span style="color: #228b22;">'Max point = ({0:1.2f}, {1:1.2f})'</span>.format(<span style="color: #8b0000;">float</span>(xmax),
                                                    <span style="color: #8b0000;">float</span>(f(xmax))))
plt.savefig(<span style="color: #228b22;">'images/splinefit.png'</span>)
</pre>
</div>

<pre class="example">
Optimization terminated successfully.
         Current function value: -0.575712
         Iterations: 12
         Function evaluations: 24
</pre>

<p><img src="/img/./images/splinefit.png"><p>

<p>
There are other good examples at <a href="http://docs.scipy.org/doc/scipy/reference/tutorial/interpolate.html" >http://docs.scipy.org/doc/scipy/reference/tutorial/interpolate.html</a>
</p>
<p>Copyright (C) 2013 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p><p><a href="/org/2013/02/27/Interpolation-with-splines.org">org-mode source</a><p>