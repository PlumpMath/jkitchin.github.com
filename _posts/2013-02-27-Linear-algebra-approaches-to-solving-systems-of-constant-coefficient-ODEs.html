---
title: Linear algebra approaches to solving systems of constant coefficient ODEs
date: 2013/02/27 14:33:11
updated: 2013/02/27 14:33:11
categories: ODE
---


<p>
<a href="http://matlab.cheme.cmu.edu/2011/10/20/linear-algebra-approaches-to-solving-systems-of-constant-coefficient-odes" >Matlab post</a>

Today we consider how to solve a system of first order, constant coefficient ordinary differential equations using linear algebra. These equations could be solved numerically, but in this case there are analytical solutions that can be derived. The equations we will solve are:
</p>

<p>
\(y'_1 = -0.02 y_1 + 0.02 y_2\)
</p>

<p>
\(y'_2 = 0.02 y_1 - 0.02 y_2\)
</p>

<p>
We can express this set of equations in matrix form as: \(\left[\begin{array}{c}y'_1\\y'_2\end{array}\right] = \left[\begin{array}{cc} -0.02 & 0.02 \\ 0.02 & -0.02\end{array}\right] \left[\begin{array}{c}y_1\\y_2\end{array}\right]\)
</p>

<p>
The general solution to this set of equations is
</p>

<p>
\(\left[\begin{array}{c}y_1\\y_2\end{array}\right] = \left[\begin{array}{cc}v_1 & v_2\end{array}\right] \left[\begin{array}{cc} c_1 & 0 \\ 0 & c_2\end{array}\right] \exp\left(\left[\begin{array}{cc} \lambda_1 & 0 \\ 0 & \lambda_2\end{array}\right] \left[\begin{array}{c}t\\t\end{array}\right]\right)\)
</p>

<p>
where \(\left[\begin{array}{cc} \lambda_1 & 0 \\ 0 & \lambda_2\end{array}\right]\) is a diagonal matrix of the eigenvalues of the constant coefficient matrix, \(\left[\begin{array}{cc}v_1 & v_2\end{array}\right]\) is a matrix of eigenvectors where the \(i^{th}\) column corresponds to the eigenvector of the \(i^{th}\) eigenvalue, and \(\left[\begin{array}{cc} c_1 & 0 \\ 0 & c_2\end{array}\right]\) is a matrix determined by the initial conditions.
</p>

<p>
In this example, we evaluate the solution using linear algebra. The initial conditions we will consider are \(y_1(0)=0\) and \(y_2(0)=150\).
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">import</span> numpy <span style="color: #8b0000;">as</span> np

A = np.array([[-0.02,  0.02],
              [ 0.02, -0.02]])

<span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">Return the eigenvalues and eigenvectors of a Hermitian or symmetric matrix.</span>
evals, evecs = np.linalg.eigh(A)
<span style="color: #8b0000;">print</span> evals
<span style="color: #8b0000;">print</span> evecs
</pre>
</div>

<pre class="example">
&gt;&gt;&gt; ... &gt;&gt;&gt; &gt;&gt;&gt; ... &gt;&gt;&gt; [-0.04  0.  ]
[[ 0.70710678  0.70710678]
 [-0.70710678  0.70710678]]
</pre>

<p>
The eigenvectors are the <i>columns</i> of evecs.
</p>

<p>
Compute the \(c\) matrix
</p>

<p>
V*c = Y0
</p>

<div class="org-src-container">

<pre class="src src-python">Y0 = [0, 150]

c = np.diag(np.linalg.solve(evecs, Y0))
<span style="color: #8b0000;">print</span> c
</pre>
</div>

<pre class="example">
&gt;&gt;&gt; &gt;&gt;&gt; [[-106.06601718    0.        ]
 [   0.          106.06601718]]
</pre>

<p>
Constructing the solution
</p>

<p>
We will create a vector of time values, and stack them for each solution, \(y_1(t)\) and \(Y_2(t)\).
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">import</span> matplotlib.pyplot <span style="color: #8b0000;">as</span> plt

t = np.linspace(0, 100)
T = np.row_stack([t, t])

D = np.diag(evals)

<span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">y = V*c*exp(D*T);</span>
y = np.dot(np.dot(evecs, c), np.exp(np.dot(D, T)))

<span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">y has a shape of (2, 50) so we have to transpose it</span>
plt.plot(t, y.T)
plt.xlabel(<span style="color: #228b22;">'t'</span>)
plt.ylabel(<span style="color: #228b22;">'y'</span>)
plt.legend([<span style="color: #228b22;">'$y_1$'</span>, <span style="color: #228b22;">'$y_2$'</span>])
plt.savefig(<span style="color: #228b22;">'images/ode-la.png'</span>)
plt.show()
</pre>
</div>

<pre class="example">
&gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; ... &gt;&gt;&gt; &gt;&gt;&gt; ... [&lt;matplotlib.lines.Line2D object at 0x1d4db950&gt;, &lt;matplotlib.lines.Line2D object at 0x1d4db4d0&gt;]
&lt;matplotlib.text.Text object at 0x1d35fbd0&gt;
&lt;matplotlib.text.Text object at 0x1c222390&gt;
&lt;matplotlib.legend.Legend object at 0x1d34ee90&gt;
</pre>

<p><img src="/img/./images/ode-la.png"><p>
<p>Copyright (C) 2013 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p><p><a href="/org/2013/02/27/Linear-algebra-approaches-to-solving-systems-of-constant-coefficient-ODEs.org">org-mode source</a><p>