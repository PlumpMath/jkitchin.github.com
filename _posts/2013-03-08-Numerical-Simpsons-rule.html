---
title: Numerical Simpsons rule
date: 2013/03/08 18:18:55
updated: 2013/03/08 18:18:55
categories: math, integration
tags: 
---


<p>

A more accurate numerical integration than the trapezoid method is <a href="http://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.simps.html" >Simpson's rule</a>. The syntax is similar to trapz, but the method is in scipy.integrate.
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">import</span> numpy <span style="color: #8b0000;">as</span> np
<span style="color: #8b0000;">from</span> scipy.integrate <span style="color: #8b0000;">import</span> simps, romb

a = 0.0; b = np.pi / 4.0;
N = 10  <span style="color: #ff0000; font-weight: bold;"># this is the number of intervals</span>

x = np.linspace(a, b, N)
y = np.cos(x)

t = np.trapz(y, x)
s = simps(y, x)
a = np.sin(b) - np.sin(a)

<span style="color: #8b0000;">print</span>
<span style="color: #8b0000;">print</span> <span style="color: #228b22;">'trapz = {0} ({1:%} error)'</span>.format(t, (t - a)/a)
<span style="color: #8b0000;">print</span> <span style="color: #228b22;">'simps = {0} ({1:%} error)'</span>.format(s, (s - a)/a)
<span style="color: #8b0000;">print</span> <span style="color: #228b22;">'analy = {0}'</span>.format(a)
</pre>
</div>

<pre class="example">
&gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt;
trapz = 0.70665798038 (-0.063470% error)
simps = 0.707058914216 (-0.006769% error)
analy = 0.707106781187
</pre>

<p>
You can see the Simpson's method is more accurate than the trapezoid method.
</p>
<p>Copyright (C) 2013 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p><p><a href="/org/2013/03/08/Numerical-Simpsons-rule.org">org-mode source</a><p>