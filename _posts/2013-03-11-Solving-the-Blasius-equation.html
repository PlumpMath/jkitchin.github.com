---
title: Solving the Blasius equation
date: 2013/03/11 10:44:56
updated: 2013/03/11 16:34:47
categories: BVP
tags: fluids
---


<p>
In fluid mechanics the Blasius equation comes up (<a href="http://en.wikipedia.org/wiki/Blasius_boundary_layer" >http://en.wikipedia.org/wiki/Blasius_boundary_layer</a>) to describe the boundary layer that forms near a flat plate with fluid moving by it. The nonlinear differential equation is:
</p>

\begin{eqnarray}
f''' + \frac{1}{2} f f'' &=& 0 \\
f(0) &=& 0 \\
f'(0) &=& 0 \\
f'(\infty) &=& 1
\end{eqnarray}

<p>
This is a nonlinear, boundary value problem. The point of solving this equation is to get the value of \(f''(0)\) to evaluate the shear stress at the plate. 
</p>

<p>
We have to convert this to a system of first-order differential equations. Let \(f_1 = f\), \(f_2 = f_1'\) and \(f_3 = f_2'\). This leads to:
</p>

\begin{eqnarray}
f_1' = f_2 \\
f_2' = f_3 \\
f_3' = -\frac{1}{2} f_1 f_3 \\
f_1(0) = 0 \\
f_2(0) = 0 \\
f_2(\infty) = 1
\end{eqnarray}

<p>
It is not possible to specify a boundary condition at \(\infty\) numerically, so we will have to use a large number, and verify it is &ldquo;large enough&rdquo;. From the solution, we evaluate the derivatives at \(\eta=0\), and we have \(f''(0) = f_3(0)\).
</p>

<p>
We have to provide initial guesses for f_1, f_2 and f_3. This is the hardest part about this problem. We know that f_1 starts at zero, and is flat there (f'(0)=0), but at large eta, it has a constant slope of one. We will guess a simple line of slope = 1 for f_1. That is correct at large eta, and is zero at &eta;=0. If the slope of the function is constant at large \(\eta\), then the values of higher derivatives must tend to zero. We choose an exponential decay as a guess. 
</p>

<p>
Finally, we let a solver iteratively find a solution for us, and find the answer we want. The solver is in the pycse module.
</p>


<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">import</span> numpy <span style="color: #8b0000;">as</span> np
<span style="color: #8b0000;">from</span> pycse <span style="color: #8b0000;">import</span> bvp

<span style="color: #8b0000;">def</span> <span style="color: #8b2323;">odefun</span>(F, x):
    f1, f2, f3 = F
    <span style="color: #8b0000;">return</span> [f2,  
            f3,             
            -0.5 * f1 * f3] 

<span style="color: #8b0000;">def</span> <span style="color: #8b2323;">bcfun</span>(Fa, Fb):
    <span style="color: #8b0000;">return</span> [Fa[0],        <span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">f1(0) =  0</span>
            Fa[1],        <span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">f2(0) = 0</span>
            1.0 - Fb[1]]  <span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">f2(inf) = 1</span>

eta = np.linspace(0, 6, 100)
f1init = eta
f2init = np.exp(-eta)
f3init = np.exp(-eta)

Finit = np.vstack([f1init, f2init, f3init])

sol = bvp(odefun, bcfun, eta, Finit)

<span style="color: #8b0000;">print</span> <span style="color: #228b22;">"f''(0) = f_3(0) = {0}"</span>.format(sol[2, 0])

<span style="color: #8b0000;">import</span> matplotlib.pyplot <span style="color: #8b0000;">as</span> plt
plt.plot(eta, sol[0])
plt.xlabel(<span style="color: #228b22;">'$\eta$'</span>)
plt.ylabel(<span style="color: #228b22;">'$f(\eta)$'</span>)
plt.savefig(<span style="color: #228b22;">'images/blasius.png'</span>)
</pre>
</div>

<pre class="example">
f''(0) = f_3(0) = 0.332491109552
</pre>

<p><img src="/img/./images/blasius.png"><p>
<p>Copyright (C) 2013 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p><p><a href="/org/2013/03/11/Solving-the-Blasius-equation.org">org-mode source</a><p>