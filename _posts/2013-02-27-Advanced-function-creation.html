---
title: Advanced function creation
date: 2013/02/27 14:49:54
updated: 2013/03/06 18:28:13
categories: python
tags: 
---


<p>
Python has some nice features in creating functions. You can create default values for variables, have optional variables and optional keyword variables.
In this function f(a,b), <code>a</code> and <code>b</code> are called positional arguments, and they are required, and must be provided in the same order as the function defines.
</p>

<p>
If we provide a default value for an argument, then the argument is called a keyword argument, and it becomes optional. You can combine positional arguments and keyword arguments, but positional arguments must come first. Here is an example.
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">def</span> <span style="color: #8b2323;">func</span>(a, n=2):
    <span style="color: #228b22;">"compute the nth power of a"</span>
    <span style="color: #8b0000;">return</span> a**n

<span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">three different ways to call the function</span>
<span style="color: #8b0000;">print</span> func(2)
<span style="color: #8b0000;">print</span> func(2, 3)
<span style="color: #8b0000;">print</span> func(2, n=4)
</pre>
</div>

<pre class="example">
4
8
16
</pre>

<p>
In the first call to the function, we only define the argument <code>a</code>, which is a mandatory, positional argument. In the second call, we define <code>a</code> and <code>n</code>, in the order they are defined in the function. Finally, in the third call, we define <code>a</code> as a positional argument, and <code>n</code> as a keyword argument.
</p>

<p>
If all of the arguments are optional, we can even call the function with no arguments. If you give arguments as positional arguments, they are used in the order defined in the function. If you use keyword arguments, the order is arbitrary.
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">def</span> <span style="color: #8b2323;">func</span>(a=1, n=2):
    <span style="color: #228b22;">"compute the nth power of a"</span>
    <span style="color: #8b0000;">return</span> a**n

<span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">three different ways to call the function</span>
<span style="color: #8b0000;">print</span> func()
<span style="color: #8b0000;">print</span> func(2, 4)
<span style="color: #8b0000;">print</span> func(n=4, a=2)
</pre>
</div>

<pre class="example">
1
16
16
</pre>

<p>
It is occasionally useful to allow an arbitrary number of arguments in a function. Suppose we want a function that can take an arbitrary number of positional arguments and return the sum of all the arguments. We use the syntax <code>*args</code> to indicate arbitrary positional arguments. Inside the function the variable <code>args</code> is a tuple containing all of the arguments passed to the function. 
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">def</span> <span style="color: #8b2323;">func</span>(*args):
    <span style="color: #8b0000;">sum</span> = 0
    <span style="color: #8b0000;">for</span> arg <span style="color: #8b0000;">in</span> args:
        <span style="color: #8b0000;">sum</span> += arg
    <span style="color: #8b0000;">return</span> <span style="color: #8b0000;">sum</span>

<span style="color: #8b0000;">print</span> func(1, 2, 3, 4)
</pre>
</div>

<pre class="example">
10
</pre>

<p>
A more &ldquo;functional programming&rdquo; version of the last function is given here. This is an advanced approach that is less readable to new users, but more compact and likely more efficient for large numbers of arguments.
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">import</span> operator
<span style="color: #8b0000;">def</span> <span style="color: #8b2323;">func</span>(*args):
    <span style="color: #8b0000;">return</span> <span style="color: #8b0000;">reduce</span>(operator.add, args)
<span style="color: #8b0000;">print</span> func(1, 2, 3, 4)
</pre>
</div>

<pre class="example">
10
</pre>

<p>
It is possible to have arbitrary keyword arguments. This is a common pattern when you call another function within your function that takes keyword arguments. We use <code>**kwargs</code> to indicate that arbitrary keyword arguments can be given to the function. Inside the function, kwargs is variable containing a dictionary of the keywords and values passed in.
</p>

<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">def</span> <span style="color: #8b2323;">func</span>(**kwargs):
    <span style="color: #8b0000;">for</span> kw <span style="color: #8b0000;">in</span> kwargs:
        <span style="color: #8b0000;">print</span> <span style="color: #228b22;">'{0} = {1}'</span>.format(kw, kwargs[kw])

func(t1=6, color=<span style="color: #228b22;">'blue'</span>)
</pre>
</div>

<pre class="example">
color = blue
t1 = 6
</pre>

<p>
A typical example might be:
</p>
<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">import</span> matplotlib.pyplot <span style="color: #8b0000;">as</span> plt

<span style="color: #8b0000;">def</span> <span style="color: #8b2323;">myplot</span>(x, y, fname=<span style="color: #8b0000;">None</span>, **kwargs):
    <span style="color: #228b22;">"make plot of x,y. save to fname if not None. provide kwargs to plot"</span>
    plt.plot(x, y, **kwargs)
    plt.xlabel(<span style="color: #228b22;">'X'</span>)
    plt.ylabel(<span style="color: #228b22;">'Y'</span>)
    plt.title(<span style="color: #228b22;">'My plot'</span>)
    <span style="color: #8b0000;">if</span> fname:
        plt.savefig(fname)
    <span style="color: #8b0000;">else:</span>
        plt.show()

x = [1, 3, 4, 5]
y = [3, 6, 9, 12]

myplot(x, y, <span style="color: #228b22;">'images/myfig.png'</span>, color=<span style="color: #228b22;">'orange'</span>, marker=<span style="color: #228b22;">'s'</span>)

<span style="color: #ff0000; font-weight: bold;"># </span><span style="color: #ff0000; font-weight: bold;">you can use a dictionary as kwargs</span>
d = {<span style="color: #228b22;">'color'</span>:<span style="color: #228b22;">'magenta'</span>,
     <span style="color: #228b22;">'marker'</span>:<span style="color: #228b22;">'d'</span>}

myplot(x, y, <span style="color: #228b22;">'images/myfig2.png'</span>, **d)
</pre>
</div>

<p><img src="/img/./images/myfig.png"><p>

<p><img src="/img/./images/myfig2.png"><p>

<p>
In that example we wrap the matplotlib plotting commands in a function, which we can call the way we want to, with arbitrary optional arguments. In this example, you cannot pass keyword arguments that are illegal to the plot command or you will get an error.
</p>

<p>
It is possible to combine all the options at once. I admit it is hard to imagine where this would be really useful, but it can be done!
</p>
<div class="org-src-container">

<pre class="src src-python"><span style="color: #8b0000;">import</span> numpy <span style="color: #8b0000;">as</span> np

<span style="color: #8b0000;">def</span> <span style="color: #8b2323;">func</span>(a, b=2, *args, **kwargs):
    <span style="color: #228b22;">"return a**b + sum(args) and print kwargs"</span>
    <span style="color: #8b0000;">for</span> kw <span style="color: #8b0000;">in</span> kwargs:
        <span style="color: #8b0000;">print</span> <span style="color: #228b22;">'kw: {0} = {1}'</span>.format(kw, kwargs[kw])

    <span style="color: #8b0000;">return</span> a**b + np.sum(args)

<span style="color: #8b0000;">print</span> func(2, 3, 4, 5, mysillykw=<span style="color: #228b22;">'hahah'</span>)
</pre>
</div>

<pre class="example">
kw: mysillykw = hahah
17
</pre>
<p>Copyright (C) 2013 by John Kitchin. See the <a href="/copying.html">License</a> for information about copying.<p><p><a href="/org/2013/02/27/Advanced-function-creation.org">org-mode source</a><p>