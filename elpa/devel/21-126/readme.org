
Here I create the pkg file with a new version in it. 

#+BEGIN_SRC sh :var version=0.3 :results value
echo "(define-package \"21-126\" \"$version\" \"Introduction to Mathematical Software\" (quote nil))" > 21-126-pkg.el

# remove old files
rm -f ../21-126-$version.tar
rm -fr ../21-126-$version

# make new dir
mkdir ../21-126-$version

# copy everything here to new dir
cp -R * ../21-126-$version

# create tar file for installation
tar -cf ../21-126-$version.tar ../21-126-$version

# remove old dir
rm -fr ../21-126-$version

echo $version
#+END_SRC

#+RESULTS:

Now, we install it using emacs.
#+BEGIN_SRC emacs-lisp :var version=0.3
(package-install-file 
 (expand-file-name 
  (format "21-126-%s.tar" version)
  ".."))
#+END_SRC

#+RESULTS:
: t

