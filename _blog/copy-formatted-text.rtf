{\rtf1\ansi\deff0
{\fonttbl
{\f0\froman Times;}
{\f1\fswiss Arial;}
{\f2\fmodern Courier New;}}
{\b Copy formatted org-mode text from Emacs to other applications}\par   {\pardIt occurred to me that some applications can copy formatted text which I can paste into MS Word. I thought it would be great if I could do this from org-mode. For example, if I had some references formatted in org-mode, I could copy and paste them to Word, keeping the formatting. Curiosity got the better of me and I wondered how this is done. It works by creating a {\cf2\field{\*\fldinst{HYPERLINK "https://www.safaribooksonline.com/library/view/rtf-pocket-guide/9781449302047/ch01.html"}}{\fldrslt{\ul Rich Text Format}}} version of what you want to copy and then get it to the clipboard. It isn't quite enough to just copy it, it needs to go in the clipboard as an RTF datatype. On Mac OSX I used {\cf2\field{\*\fldinst{HYPERLINK "http://osxdaily.com/2007/03/05/manipulating-the-clipboard-from-the-command-line/"}}{\fldrslt{\ul pbcopy}}} to make that happen.
  \par\sa1}

  {\pardThe strategy I came up with is to create a derived backend that exports a highlighted region as RTF to a temporary buffer, and then runs pbcopy on that buffer to get it on the clipboard. Then, I can switch to Word, and paste it in with Word formatting!
  \par\sa1}


{\b An example}\par   {\pardHere is some example text:
  \par\sa1}

  {\pardSome {\b bold}, {\i italic}, {\ul underline}, {\strike struck} and {\f2 verbatim} text to copy. Here are some example sub/superscripts: H{\sub 2}O with no H{\super +} in it it.
  \par\sa1}

  {\rtf1\ansi\uc0 \deff1{\fonttbl{\f1\fmodern\fprq1\fcharset0 Courier New;}}{\colortbl;\red224\green234\blue238;\red00\green00\blue00;\red191\green03\blue03;\red176\green126\blue00;\red131\green129\blue131;\red131\green129\blue131;\red255\green00\blue255;\red00\green130\blue00;\red129\green129\blue00;\red85\green85\blue85;\red00\green00\blue00;\red00\green87\blue174;\red00\green00\blue00;\red00\green87\blue174;\red00\green00\blue00;\red01\green01\blue129;}
  \paperw11905\paperh16837\margl1134\margr1134\margt1134\margb1134\sectd\plain\f1\fs20
  \pard \cbpat1{{\cf2{}}{\cf13{\b import\b0 }} {\cf2{pycse}}{\cf11{.}}{\cf2{orgmode}} {\cf13{\b as\b0 }} {\cf2{org}}}\par\pard
  \cbpat1{{\cf13{\b import\b0 }} {\cf2{numpy}} {\cf13{\b as\b0 }} {\cf2{np}}}\par\pard
  \cbpat1{{\cf13{\b import\b0 }} {\cf2{matplotlib}}{\cf11{.}}{\cf2{pyplot}} {\cf13{\b as\b0 }} {\cf2{plt}\par\pard
  \cbpat1{}\par\pard
  \cbpat1{x}} {\cf11{=}} {\cf2{np}}{\cf11{.}}{\cf2{}}{\cf16{linspace}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf4{{0}}}{\cf2{}}{\cf11{,}} {\cf2{}}{\cf4{{6}{0}}}{\cf2{}}{\cf11{,}} {\cf2{}}{\cf4{{5}{0}{0}}}{\cf2{}}{\cf11{)}}}\par\pard
  \cbpat1{{\cf2{plt}}{\cf11{.}}{\cf2{}}{\cf16{plot}}{\cf2{}}{\cf11{(}}{\cf2{np}}{\cf11{.}}{\cf2{}}{\cf16{exp}}{\cf2{}}{\cf11{(-}}{\cf2{}}{\cf4{{0}.{1}}} {\cf2{}}{\cf11{*}} {\cf2{x}}{\cf11{) *}} {\cf2{np}}{\cf11{.}}{\cf2{}}{\cf16{cos}}{\cf2{}}{\cf11{(}}{\cf2{x}}{\cf11{),}}}\par\pard
  \cbpat1{{\cf2{         np}}{\cf11{.}}{\cf2{}}{\cf16{exp}}{\cf2{}}{\cf11{(-}}{\cf2{}}{\cf4{{0}.{1}}} {\cf2{}}{\cf11{*}} {\cf2{x}}{\cf11{) *}} {\cf2{np}}{\cf11{.}}{\cf2{}}{\cf16{sin}}{\cf2{}}{\cf11{(}}{\cf2{x}}{\cf11{))}}}\par\pard
  \cbpat1{{\cf2{org}}{\cf11{.}}{\cf2{}}{\cf16{figure}}{\cf2{}}{\cf11{(}}{\cf2{plt}}{\cf11{.}}{\cf2{}}{\cf16{savefig}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf3{'spiral.png'}}{\cf2{}}{\cf11{),}}}\par\pard
  \cbpat1{{\cf2{           caption}}{\cf11{=}}{\cf2{}}{\cf3{'A spiral.'}}{\cf2{}}{\cf11{,}}}\par\pard
  \cbpat1{{\cf2{           attributes}}{\cf11{=[[}}{\cf2{}}{\cf3{'org'}}{\cf2{}}{\cf11{,}} {\cf2{}}{\cf3{':width {1}{0}{0}'}}{\cf2{}}{\cf11{]])}}}\par\pard
  \cbpat1{{\cf2{}}{\cf13{\b print\b0 }}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf3{''}}{\cf2{}}{\cf11{)}}}\par\pard
  \cbpat1{{\cf2{org}}{\cf11{.}}{\cf2{}}{\cf16{table}}{\cf2{}}{\cf11{([[}}{\cf2{}}{\cf3{'H{1}'}}{\cf2{}}{\cf11{,}} {\cf2{}}{\cf3{'H{2}'}}{\cf2{}}{\cf11{],}} {\cf2{}}{\cf13{\b None\b0 }}{\cf2{}}{\cf11{, [}}{\cf2{}}{\cf4{{1}}}{\cf2{}}{\cf11{,}} {\cf2{}}{\cf4{{2}}}{\cf2{}}{\cf11{], [}}{\cf2{}}{\cf4{{2}}}{\cf2{}}{\cf11{,}} {\cf2{}}{\cf4{{4}}}{\cf2{}}{\cf11{]])}}}\par\pard
  \cbpat1{{\cf2{}}{\cf13{\b print\b0 }}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf3{''}}{\cf2{}}{\cf11{)}}}\par\pard
  \cbpat1{{\cf2{org}}{\cf11{.}}{\cf2{}}{\cf16{result}}{\cf2{}}{\cf11{(}}{\cf2{}}{\cf4{{6}}} {\cf2{}}{\cf11{*}} {\cf2{}}{\cf4{{7}}}{\cf2{}}{\cf11{)}}{\cf2{}}}\par\pard
  \cbpat1{}}

  {\fonttbl
  {\f0\froman Times;}
  {\f1\fswiss Arial;}
  {\f2\fmodern Courier New;}}\f0

  {\pard{\field\fldedit{\*\fldinst { INCLUDEPICTURE  \\d
   "/Users/jkitchin/blogofile-jkitchin.github.com/_blog/spiral.png"
   \\* MERGEFORMATINET }}{\fldrslt {  }}}
  \par\sa1}

  {\f1 | H1 | H2 |}\line
  {\f1 |----+----|}\line
  {\f1 |  1 |  2 |}\line
  {\f1 |  2 |  4 |}\line
  {\f1 }\line

  {\f2 42
  \line}



  1. {\pardJohn R. Kitchin, {\i Examples of Effective Data Sharing in Scientific Publishing}, {\b ACS Catalysis}, 5(6), pp. 3894-3899 (2015). doi:10.1021/acscatal.5b00538.
     \par\sa1}

  2. {\pardJohn R. Kitchin;  Ana E. Van Gulick and  Lisa D. Zilinski, {\i Automating Data Sharing Through Authoring Tools}, {\b International Journal on Digital Libraries}, pp. 1--6 (2016). doi:10.1007/s00799-016-0173-7.
     \par\sa1}


{\b Things to come}\par   {\pardWe can do footnotes. {\super\chftn}{\footnote\pard\plain\chftn It would be nice to get figure captions working.}
  \par\sa1}

  1. {\pardAn org-ref RTF exporter?
     \par\sa1}
     - {\pardColors are a little fragile
       \par\sa1}
     - {\pardmissing list support
       \par\sa1}

  {\pard* A list item.
  \par\sa1}

  1. {\pardProper table export?
     \par\sa1}
  2. {\pardThe rest of the org elements.
     \par\sa1}
  3. {\pardExport to RTF files
     \par\sa1}


{\b test}\par   {\pard{\cf2\field{\*\fldinst{HYPERLINK "https://github.com/jwiegley/dot-emacs/blob/master/lisp/copy-code.el"}}{\fldrslt{\ul link}}}
  \par\sa1}

  {\pard{\cf2\field{\*\fldinst{HYPERLINK "https://github.com/jwiegley/dot-emacs/blob/master/lisp/copy-code.el"}}{\fldrslt{\ul https://github.com/jwiegley/dot-emacs/blob/master/lisp/copy-code.el}}}
  \par\sa1}

  {\pard{\cf2\field{\*\fldinst{HYPERLINK "http://www.pindari.com/rtf1.html"}}{\fldrslt{\ul http://www.pindari.com/rtf1.html}}}
  \par\sa1}
}