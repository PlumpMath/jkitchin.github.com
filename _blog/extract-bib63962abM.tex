% Created 2015-01-28 Wed 09:07
\documentclass[11pt]{article}
\usepackage[utf8]{inputenc}
\usepackage{lmodern}
\usepackage[T1]{fontenc}
\usepackage{fixltx2e}
\usepackage{graphicx}
\usepackage{longtable}
\usepackage{float}
\usepackage{wrapfig}
\usepackage{rotating}
\usepackage[normalem]{ulem}
\usepackage{amsmath}
\usepackage{textcomp}
\usepackage{marvosym}
\usepackage{wasysym}
\usepackage{amssymb}
\usepackage{amsmath}
\usepackage[version=3]{mhchem}
\usepackage[numbers,super,sort&compress]{natbib}
\usepackage{natmove}
\usepackage{url}
\usepackage{minted}
\usepackage{underscore}
\usepackage[linktocpage,pdfstartview=FitH,colorlinks,
linkcolor=blue,anchorcolor=blue,
citecolor=blue,filecolor=blue,menucolor=blue,urlcolor=blue]{hyperref}
\usepackage{attachfile}
\author{John Kitchin}
\date{\today}
\title{extract-bib63962abM}
\begin{document}

\tableofcontents

\section{An exporter for org to docx via pandoc}
\label{sec-1}

The idea here is to write a function that converts your org document to a word document using pandoc. There is not much we need to do, but we would like to convert citations to the format used by pandoc.

\begin{minted}[frame=lines,fontsize=\scriptsize,linenos]{common-lisp}
(defun pandoc-cite-format (link contents info)
  (let ((type (org-element-property :type link))
        (path (org-element-property :path link)))
    (cond
     ((string= type "cite")
      (format "[%s]"
              (mapconcat
               (lambda (x) (concat "@" x))
               (split-string path ",")
               "; ")
              ))
     ;; anything else, we just do the regular thing
     (t
      (org-html-link link contents info)))))

(org-export-define-derived-backend 'pandoc-docx 'org
  :translate-alist '((link . pandoc-cite-format)))
\end{minted}

\begin{verbatim}
[cl-struct-org-export-backend pandoc-docx org ((link . pandoc-cite-format)) nil nil nil nil]
\end{verbatim}

Here are some references to test pandoc it.. And a multiple reference.

pandoc it.

This will export our file with converted links.
\begin{minted}[frame=lines,fontsize=\scriptsize,linenos]{common-lisp}
(org-export-to-file 'pandoc-docx "some-filename.org")
\end{minted}

So, we need to get the bibliography file from the org file.

(expand-file-name (car (org-ref-find-bibliography)))

\begin{minted}[frame=lines,fontsize=\scriptsize,linenos]{common-lisp}
(shell-command "rm some-filename.docx")
(find-file (org-export-to-file 'pandoc-docx "some-filename.org"))
(shell-command (format "pandoc -s -S --biblio=%s %s -o %s"
(expand-file-name (car (org-ref-find-bibliography)))
(buffer-file-name)
(replace-regexp-in-string "\\.org" ".docx" (buffer-file-name))))
(shell-command (format "open %s" (replace-regexp-in-string "\\.org" ".docx" (buffer-file-name))))
\end{minted}

\begin{verbatim}
1
\end{verbatim}

\url{./some-filename.docx}
bibliography:
% Emacs 24.4.1 (Org mode 8.2.10)
\end{document}